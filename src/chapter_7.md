# Глава 7. Три мини игры

На основе рассмотренной в первой главе повести мы создадим визуальную новеллу на Ren’Py, Twine и TyranoBuilder под 
названием _"Август возвращается"_. В процессе создания предпочтение будет предоставлено больше Ren’Py.

Хотя вы можете написать свою собственную историю, однако, чтобы это сделать правильно, лучше сперва познакомьтесь, как 
происходит процесс превращения повести в игру.

## Составляем план

Перед программированием, желательно составить план для вашего приключения, то есть сделать каталогизацию персонажей, 
определить сцены. Может показаться это лишним, но без этого не обойтись при работе в больших командах.

Сначала разложим повесть _"Август возвращается"_ на блоки в виде таблиц. Так же вы можете воспользоваться другим методом 
визуализации для этих целей. Главное – не пропускать данный этап, во избежание негативных последствий при создании игры.

### Состав персонажей

Начнем с персонажей (см. Таблицу 7-1). Если забыли про них, то вернитесь к первой главе книги.

В это же главе повторите материал про 12 архетипов личности Джозефа Кэмпбелла, некоторые из них будут использованы в 
создаваемой игре.

__Таблица 7-1.__ Главные герои

| Герой                         | Роль/Архетип                | Пол и Возраст         | Внешний вид                                                 |
|-------------------------------|-----------------------------|-----------------------|-------------------------------------------------------------|
| _**Рон Легион-Смерти**_       | Главный герой (т. е. игрок) | Мужчина, около 30 лет | Среднего телосложения и роста, на вид физически подтянутый  |
| _**Мервин Попплуэлл**_        | Искатель                    | Мужчина, лет за 30    | Худой, среднего роста, небрежно одетый                      |
| _**Ройстон Медовая-Бабочка**_ | Мудрец                      | Мужчина, 50 лет       | Крепкое телосложение, имеет обычный вид                     |
| _**Клэр**_                    | Правитель                   | Женщина, около 20 лет | Спортивное телосложение, среднего роста, модно одетая       |
| _**Человек в комбинезоне**_   | Бунтарь                     | Мужчина, без возраста | Спортивное телосложение, высокий, лысый с причудливым видом |
| _**Рейн**_                    | Любовник                    | Женщина, около 30 лет | Среднее телосложение, низкий рост, изящный вид              |

### Локации

В визуальных новеллах главное не количество локаций, а количество слов в повествовании. В среднем это от 10000 до 50000 
слов.

> Примечание:
> 
> Игра, создаваемая в этой книге, не соответствует вышеуказанному правилу.

По сравнению с каталогизацией персонажей, определиться с локациями событий в игре сложнее. Слишком малое количество 
портят атмосферу, а слишком много сбивают с толку игрока. Лучше всего начать с малого, определить основные элементы 
игры, после чего разделить их на более мелкие единицы (например, комнаты) (см. Таблицу 7-2).

Для построения истории мы воспользуемся такими понятиями как:

* **Сеттинг** – это среда, в которой происходит действие, где определяются базовые свойства реальности. В нашем случае 
это общая тема, атмосфера происходящего (например, стиль фона).
* **Место**, обстоятельство и время при которых развиваются события. Здесь могут быть применены разные звуковые дорожки,
задний фон.
* **Комнаты** – наименьшая единица локации игры, которые часто имеют связь между собой.

__Таблица 7-2.__ Основные сеттинги и места повести "Август возвращается"

| Сеттинг                              | Место                                      | Пример описание комнаты                                                                                                                                                                           |
|--------------------------------------|--------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| _**Офис**_                           | _Рабочее место Рона_                       | Вы бездельничаете за рабочим столом, на котором среди стопок бумаг стоит персональный компьютер. Только наклейка с изображением женщины-киборга выделяет ваше рабочее место среди всех остальных. |
| _**Офис**_                           | _Помещение, где храниться сотовый телефон_ | Поднявшись на верхний этаж, вы попадаете в заброшенную часть офиса со старой мебелью.                                                                                                             |
| _**Город**_                          | _Парк, Арка_                               | Ночь, одинокая арка городского парка, статуи освещённые тусклым светом, только усиливают волнения и страх вызванный недавними событиями.                                                          |
| _**Офис (Пожар)**_                   | _Рабочий стол Рона_                        | Ад. Рабочее место Рона окутано огнём. Защищаясь портфелем, он ныряет в него.                                                                                                                      |
| _**Город (Жилой район)**_            | _Квартира Рона_                            | Квартира главного героя становится не такой безопасной, когда из-за двери доносятся странные звуки.                                                                                               |
| _**Город (Железнодорожный вокзал)**_ | _Железнодорожный вокзал_                   | Вы испуганный, лихорадочно просматриваете расписание движения поездов в поиске ближайшего, который готов к отправке.                                                                              |
| _**Поезд**_                          | _Поезд на север_                           | Сидя в мягком сиденье поезда, женщина с черными волосами напротив вас сняла наушники, улыбнулась и представилась.                                                                                 |
| _**Конечная станция**_               | _Конечная станция_                         | Пытаясь слиться с толпой, вас ловят за руку.                                                                                                                                                      |
| _**Остров**_                         | _Остров_                                   | Вы высаживаетесь на острове, для вас это чужой мир. Холод проникает до дрожи костей. Корабль покидает причал, и вы остаетесь один на холодном северном ветре.                                     |
| _**Остров**_                         | _Бункер_                                   | Незаметное снаружи строение на удивление оказалось просторным, комфортным, с отличной мебелью. Это напоминало больше отель нежели бункер.                                                         |
| _**Океан**_                          | _Судно_                                    | По правому борту без опознавательных знаков появляется второе судно. Вы начинаете паниковать.                                                                                                     |
| _**Север**_                          | _Аэропорт_                                 | Вы оказываетесь в международном аэропорту, заполненным огромным количеством людей. Возможность раствориться в толпе успокаивает вас.                                                              |
| _**Город**_                          | _Аэропорт_                                 | Вас окружает беззаботная жизнь. Туристы, тянут свой багаж, но вы внутренне готовитесь к битве всей своей жизни.                                                                                   |
| _**Город**_                          | _Резиденция президента_                    | Нет времени любоваться городом. По вам открыли огонь, остается только бежать.                                                                                                                     |
| _**Новый офис**_                     | _Новое рабочее место Рона_                 | Прежде чем приступить к новым обязанностям, он с тяжестью в душе возвращает старый сотовый телефон в шкаф.                                                                                        |

Теперь разделим вышеупомянутые места на более мелкие эпизоды, а именно на комнаты. Давайте сперва это сделаем для 
сеттинга "Офис" (см. Таблицу 7-3).

__Таблица 7-3.__ Сеттинг "Офис" в повести "Август возвращается"

| Сеттинг    | Место                                          | Комната                       | Связанные комнаты                                    |
|------------|------------------------------------------------|-------------------------------|------------------------------------------------------|
| _**Офис**_ | _Рабочее место Рона_                           | _Рабочий стол Рона_           | _Зона с питьевым фонтанчиком, Рабочий стол Ройстона_ |
|            |                                                | _Зона с питьевым фонтанчиком_ | _Рабочий стол Рона, Соседний рабочий стол_           |
|            |                                                | _Соседний рабочий стол_       | _Зона с питьевым фонтанчиком_                        |
|            | _Верхний этаж (т. е. место хранение телефона)_ | _Рабочий стол Ройстона_       | _Рабочий стол Рона, Шкаф для документов_             |
|            |                                                | _Шкаф для документов_         | _Рабочий стол Ройстона_                              |

#### _Сеттинг I. Офис_

Как вы, помните, наше приключение начинается с того, что Рон получает загадочное письмо от умершего коллеги, некоего 
Мервина Попплуэлла.

Замечания по обстановки в **Офисе**:

* Тон написания должен быть мрачным и зловещим.
* Звуковое сопровождение — это рабочий шум офиса, звуки работающей аппаратуры, ксерокса, приглушенные голоса 
сотрудников, телефонный звонки и разговоры.

#### _Сеттинг II. Город_

Выполняя инструкцию из загадочного письма, мы идем по улицам города в направлении арки парка (см. Таблицу 7-4).

__Таблица 7-4.__ Сеттинг "Город" в повести "Август возвращается"

| Сеттинг     | Место   | Комната             | Связанные комнаты |
|-------------|---------|---------------------|-------------------|
| _**Город**_ | _Парк_  | _Парк_              | _Арка_            |
|             | _Арка_  | _Арка_              | _Парк_            |
|             | _Улица_ | _Дорога мимо офиса_ | _Арка_            |
|             |         | _Увиденный пожар_   | _Нет_             |

Замечание к дизайну **Города**:

* Тон письма по-прежнему должен быть зловещим.
* Звук — это уличная суета: проезжающие мимо автомобили, шаги людей, разговоры по мобильным телефонам, и иногда сигнал 
работающего светофора.

#### _Сеттинг III. Офис (Пожар)_

Это один из опасных моментов в приключениях нашего главного героя. Рон решился вернуться в свой офис, но он оказался 
охвачен огнем (см. Таблицу 7-5). Не имея средств защиты, кроме портфеля, он бросается в жерло пожара.

__Таблица 7-5.__ Сеттинг "Офис (Пожар)" в повести "Август возвращается"

| Сеттинг            | Место                  | Комната             | Связанные комнаты                    |
|--------------------|------------------------|---------------------|--------------------------------------|
| _**Город**_        | _Вход в офис со двора_ | _Переулок_          | _Пожарная лестница_                  |
| _**Офис (Пожар)**_ |                        | _Пожарная лестница_ | _Помещение офиса_                    |
|                    |                        | _Помещение офиса_   | _Рабочий стол Рона_                  |
|                    |                        | _Рабочий стол Рона_ | _Соседний стол А_                    |
|                    |                        | _Соседний стол А_   | _Рабочий стол Рона, Соседний стол Б_ |
|                    |                        | _Соседний стол Б_   | _Соседний стол А_                    |

Замечания по обстановке в сеттинге **Офис (Пожар)**:

* Тон повествования должен выражать огорчение и растерянность главного героя.
* Аудио сопровождение в данном сеттинге — это звуки пожарных машин, пламени и обрушения внутри здания.

#### _Сеттинг IV. Город (Жилой район)_

В этой точке сюжета Рон направляется домой. Но и здесь что-то происходит непонятное. Он слышит, странные звуки из своей 
квартиры. Рон чувствует интуицией, что если туда войдет, то уже никогда из неё не выйдет (см. Таблицу 7-6).

__Таблица 7-6.__ Сеттинг "Город (Жилой район)" в повести "Август возвращается"

| Сеттинг                   | Место           | Комната               | Связанные комнаты        |
|---------------------------|-----------------|-----------------------|--------------------------|
| _**Город (Жилой район)**_ | _Квартира Рона_ | _Улица_               | _Нет_                    |
|                           |                 | _Коридор_             | _Улица_                  |
|                           |                 | _Дверь квартира Рона_ | _Коридор, Квартира Рона_ |
|                           |                 | _Квартира Рона_       | _Нет_                    |

Замечание к дизайну **Город (Жилой район)**:

* Написание в этой короткой, но напряженной сцене, должно передавать чувство обреченности.
* Что касается аудио, то мы должны услышать эхо шагов и непривычные инопланетные звуки.

#### _Сеттинг V. Город (Железнодорожный вокзал)_

Теперь, находиться в городе стало опасно для жизни Рона, его нужно немедленно покинуть, из-за чего он как можно скорей 
пытается добраться до вокзала. Где Рон садится на первый поезд, идущий на север (см. Таблицу 7-7).

__Таблица 7-7.__ Сеттинг "Город (Железнодорожный вокзал)" в повести "Август возвращается"

| Сеттинг                              | Место                    | Комната       | Связанные комнаты     |
|--------------------------------------|--------------------------|---------------|-----------------------|
| _**Город (Железнодорожный вокзал)**_ | _Железнодорожный вокзал_ | _Статуя_      | _Платформа А_         |
|                                      |                          | _Платформа А_ | _Статуя, Платформа Б_ |
|                                      |                          | _Платформа Б_ | _Поезд_               |
|                                      |                          | _Поезд_       | _Нет_                 |

Замечание к дизайну **Город (Железнодорожный вокзал)**:

* Тон написания остаётся прежним. Рона преследуют, и он в панике.
* Звук в этом сеттинге такой же, как и в городе, только сообщает о присутствии большого количества людей.

#### _Сеттинг VI. Поезд_

Зайдя в поезд, Рон немного успокаивается. Однако это спокойствие длится недолго, его продолжают преследовать 
(см. Таблицу 7-8). В результате он запирается в туалете, прячась от преследователей. В этот момент ему позвонили на 
старый мобильный телефон, и сказали покинуть поезд на ближайшей станции.

__Таблица 7-8.__ Сеттинг "Поезд" в повести "Август возвращается"

| Сеттинг     | Место            | Комната           | Связанные комнаты            |
|-------------|------------------|-------------------|------------------------------|
| _**Поезд**_ | _Поезд на север_ | _Двери поезда_    | _Нет_                        |
|             |                  | _Первый вагон_    | _Второй вагон, Двери поезда_ |
|             |                  | _Второй вагон_    | _Первый вагон_               |
|             |                  | _Туалет в поезде_ | _Второй вагон, Третий вагон_ |
|             |                  | _Третий вагон_    | _Нет_                        |

Замечание к дизайну сеттинга **Поезд**:

* Обстановка в плане драматичности остаётся прежней и усиливается к завершению данного сеттинга.
* Атмосфера – тихий шум движущегося поезда.

#### _Сеттинг VII. Конечная станция_

Рон, не зная, что делать, метается по платформе, пока его не хватает кто-то за руку. Рона начинает трясти, но это 
оказался коллега из отдела технической поддержки Ройстон Медовая-Бабочка. После встречи они оказываются в парке на 
скамейке возле станции, где Рону сообщают о деталях происходящего (см. Таблицу 7-9).

__Таблица 7-9.__ Сеттинг "Конечная станция" в повести "Август возвращается"

| Сеттинг                | Место              | Комната            | Связанные комнаты            |
|------------------------|--------------------|--------------------|------------------------------|
| _**Конечная станция**_ | _Конечная станция_ | _Платформа А_      | _Платформа Б_                |
|                        |                    | _Платформа Б_      | _Платформа А, Дорога в парк_ |
|                        |                    | _Дорога в парк_    | _Скамейке в парке_           |
|                        |                    | _Скамейке в парке_ |                              |

Замечание к дизайну сеттинга **Конечная станция**:

* Не считая ситуации на платформе, сеттинг имеет расслабленный тон повествования. В этой сцене благодаря встречи с 
союзником главный герой чувствует себя в безопасности.
* Звуковое сопровождение должно быть как в сеттинге «Город», но более тихим и не таким насыщенным.

#### _Сеттинг VIII. Остров_

Когда Ройстон покинул Рона, ему снова позвонили на телефон. Рейн сообщает ему, что нужно избавиться от телефона, и 
используя поезд, паром, рыбацкую лодку, прибыть в течении трёх дней на самый дальний остров на севере (см. Таблицу 7-10).

На самом острове Рона встречает погибший Мервин Попплуэлл, и скрывшись в бункере из четырех комнат, за чашкой чая Рону 
рассказывают, что нужно закончить работу над системой безопасности «Август».

Поскольку команда не может защититься, на помощь, используя вертолет, прилетает Ройстон Медовая-Бабочка.

__Таблица 7-10.__ Сеттинг "Остров" в повести "Август возвращается"

| Сеттинг      | Место    | Комната                       | Связанные комнаты                                                                 |
|--------------|----------|-------------------------------|-----------------------------------------------------------------------------------|
| _**Остров**_ | _Остров_ | _Берег_                       | _Путь к бункеру А_                                                                |
|              |          | _Путь к бункеру А_            | _Путь к бункеру Б_                                                                |
|              |          | _Путь к бункеру Б_            | _Вход в бункер_                                                                   |
|              |          | _Вход в бункер_               | _Первая комната в бункере_                                                        |
|              | _Бункер_ | _Первая комната в бункере_    | _Вторая комната в бункере, Третья комната в бункере, Четвертая комната в бункере_ |
|              |          | _Вторая комната в бункере_    | _Первая комната в бункере, Третья комната в бункере, Четвертая комната в бункере_ |
|              |          | _Третья комната в бункере_    | _Первая комната в бункере, Вторая комната в бункере, Четвертая комната в бункере_ |
|              |          | _Четвертая комната в бункере_ | _Первая комната в бункере, Вторая комната в бункере, Третья комната в бункере_    |

Замечание к дизайну сеттинга **Остров**:

* Остров — это место, где главный герой приходит в себя и собирается с силами, все это должен отобразиться в сценарий. 
После напряженного начала на этом этапе игры игрок чувствует себя непринужденно.
* Так как события происходят на дальнем севере мы должны слышать звуки океана и сильного ветра.

#### _Сеттинг IX. Океан_

Спустя несколько дней к Рону прибывает Рейн и предлагает покинуть бункер, так как в резиденции президента произошло 
чрезвычайное происшествие. Рон принимает предложение. После чего они покидают остров, погрузившись на судно на воздушной 
подушке. Хоть это и короткая сцена, но из-за эпизода с нападением на корабль, очень напряженная (см. Таблицу 7-11).

__Таблица 7-11.__ Сеттинг "Остров" в повести "Август возвращается"

| Сеттинг     | Место                   | Комната  | Связанные комнаты |
|-------------|-------------------------|----------|-------------------|
| _**Океан**_ | _Судно_                 | _Палуба_ | _Рубка_           |
|             |                         | _Рубка_  | _Палуба_          |
|             | _Спасательный вертолёт_ | _Рубка_  | _Палуба_          |
|             |                         | _Палуба_ | _Рубка_           |

Замечание к дизайну сеттинга **Океан**:

* Тон написание должен вызывать чувство динамики и опасности. 
* Звук соответствует тону письма. Мы слышим двигатель судна, тяжелые шаги, металлическое эхо, грохот дверей, шум волн 
океана, и в итоге нарастающий звук вертолета.

#### _Сеттинг X. Север_

Рон и его друзья покинули остров и высадились на побережье материка, где их уже ждала машина, чтобы отвезти в аэропорт. 
Используя частный самолёт, они вылетают в столицу. Во время полёта они узнают про ужасные события в резиденции 
президента (см. Таблицу 7-12).

__Таблица 7-12.__ Сеттинг "Север" в повести "Август возвращается"

| Сеттинг     | Место       | Комната                 | Связанные комнаты                         |
|-------------|-------------|-------------------------|-------------------------------------------|
| _**Север**_ | _Побережье_ | _Побережье_             | _Автомобиль в аэропорт_                   |
|             | _Аэропорт_  | _Автомобиль в аэропорт_ | _Зона аэропорта А_                        |
|             |             | _Зона аэропорта А_      | _Зона аэропорта Б, Автомобиль в аэропорт_ |
|             |             | _Зона аэропорта Б_      | _Самолет в столицу_                       |
|             |             | _Самолет в столицу_     | _Нет_                                     |

Замечания к дизайну сеттинга **Север**:

* Текст в этом сеттинге должен спокойно вести повествование, так как большую часть врагов погибло в предыдущем сеттинге. 
Однако, происшествие в резиденции может поставить крест на миссии. 
* Звуковой фон должен успокаивать игрока. Можно добавить звуки поездки с берега в аэропорт, звук двигателя самолёта.

#### _Сеттинг XI. Город_

Рон и его друзья, прибыв в столицу, немедленно направляются в резиденцию президента (см. Таблицу 7-13). Где Рон 
встречает Клер и человека в комбинезоне. Им сообщают, что премьер-министр похищен, и чтобы его освободить Рон должен 
передать исходный код системы безопасности «Августа».

Рон соглашается с выдвинутыми условиями, но ухитряется обмануть врагов, подсунув им исправную систему безопасности, а 
спецназ в свою очередь обезвреживает всех сотрудников «Фракции».

В конце концов Рон оказывается дома, а когда возвращается офис, узнает, что он получает должность, которую раньше 
занимал Ройстон. Конец!

__Таблица 7-13.__ Сеттинг "Город" в повести "Август возвращается"

| Сеттинг     | Место                   | Комната                          | Связанные комнаты                |
|-------------|-------------------------|----------------------------------|----------------------------------|
| _**Город**_ | _Аэропорт_              | _Прибытие_                       | _Машине в резиденцию президента_ |
|             |                         | _Машине в резиденцию президента_ | _Лестница_                       |
|             | _Резиденция президента_ | _Лестница_                       | _Парадный вход_                  |
|             |                         | _Парадный вход_                  | _Зал, Лестница_                  |
|             |                         | _Зал_                            | _Парадный вход_                  |
|             | _Дом Рона_              | _Приемная_                       | _Спальня_                        |
|             |                         | _Спальня_                        | _Приемная, Балкон_               |
|             |                         | _Балкон_                         | _Спальня_                        |


Замечание к дизайну сеттинга **Город**:

* Тон письма должен быть сухим, холодным. Он должен показать в действиях главного героя твёрдость и расчетливость. Рон за 
нескольких недель своих приключений пережил многое, стал мудрее.
* Что касается звука, находясь в столице — это шум города, а попав в резиденцию президента – это тихая атмосфера. Так же 
мы должны выделить динамические сцены и сцены, в которых нужно принимать судьбоносные решения.

#### _Сеттинг XII. Новый офис_

Рон возвращается на работу. Офис отремонтирован за время его отсутствия, стоят новые рабочие столы и компьютеры 
(см. Таблицу 7-14).

Появляется Ройстон и говорит, что уходит на пенсию. Он предлагает Рону занять его место в отделе технической поддержки. 
Рон не задумываясь соглашается, понимая, что в будущем его ожидают новые приключения.

__Таблица 7-14.__ Сеттинг "Новый офис" в повести "Август возвращается"

| Сеттинг          | Место                                      | Комната                                            | Связанные комнаты                                    |
|------------------|--------------------------------------------|----------------------------------------------------|------------------------------------------------------|
| _**Новый офис**_ | _Новое рабочее место Рона_                 | _Рабочий стол Рона_                                | _Зона с питьевым фонтанчиком, Рабочий стол Ройстона_ |
|                  |                                            | _Соседний рабочий стол_                            | _Новое рабочее место Рона_                           |
|                  | _Помещение, где храниться сотовый телефон_ | _Рабочий стол Ройстона (Новое рабочее место Рона)_ | _Новое рабочее место Рона, Хранилище документов_     |
|                  |                                            | _Хранилище документов_                             | _Рабочий стол Ройстона_                              |

Замечание к дизайну сеттинга **Новый офис**:

* Текст должен вызывать чувство триумфа и оптимизма.
* В этом сеттинге мы должны слышать спокойную рабочую обстановку в офисе.

## Часть I: Начало "Август возвращается" в Ren’Py

Теперь пришло время приступить к написанию кода. "Август возвращается" имеет 61 комнату, приблизительно от 2000 до 2500 
слов, и этого достаточно чтобы познакомится с процессом разработки игр в Ren’Py.

### Создание проекта

На Лаунчере Ren’Py нажмите _"Добавить новый проект"_. У вас запросят указать имя проекта на латинице, в нашем случае — 
это _"Avgust Vozvrashaetsya"_. Затем выбираем разрешение для проекта, по умолчанию это 1920x1080 (Full HD) и нажимаем 
_"Продолжить"_. На следующем шаге задаём _цветовую схему_ игры. Если возникнет потребность данные параметры можно будет 
изменить. После нажатия _"Продолжить"_, Ren’Py выполнить процесс создания проекта и вернёт вас на главный экран лаунчера. 

В левой части в разделе _"Проекты"_, выберите "Avgust Vozvrashaetsya". Далее в разделе _"Редактировать файл"_ нажмите 
на файле _script.rpy_. Он откроется в текстовом редакторе. Это основной скрипт игры. На протяжении данной главы мы в 
основном будем работать только с ним.

Нужно отметить, что скрипты Ren’Py очень чувствительны к пробелам и синтаксису. Например, некоторые текстовые редакторы 
выполняют авто форматирование и заменяют _обычные кавычки_ на _изогнутые_. Это приводит к тому, что Ren’Py не может 
выполнить скрипт. Желательно отключите авто форматирование в вашем текстовом редакторе или используйте IDE 
(интегрированную среду разработки).

### Настройка персонажей

По умолчанию в файле сценария присутствует персонаж Эйлин. Мы его заменим на свой список персонажей указав имя и цвет 
диалога.

Для цвета в Ren’Py используется шестнадцатеричный формат, как и в HTML. В котором первые две цифры это красный цвет, 
следующие две – зелёный, а последние две – синий. Диапазон значений состоит от 0 до 9, потом от A до F. Например, 
красный цвет имеет значение: _#FF0000_, а черный: _#000000_.

Откройте файл script.rpy и найдите следующую строку:

```python
define e = Character('Эйлин', color="#c8ffc8")
```

И вместо неё вставьте следующий код:

```python
define reg = Character("Рон Легион-Смерти", color="#0099BB")
define merv = Character("Мервин Попплуэлл", color="#007799")
define roy = Character("Ройстон Медовая-Бабочка", color="#0044CC")
define rai = Character("Рейн", color="#8888EE")
define cla = Character("Клэр", color="#AA1100")
define man = Character("Человек в комбинезоне", color="#EE1100")
```

Как видим для каждого персонажа задаётся имя и цвет диалога, а сам персонаж в свою очередь присваивается константе виде 
сокращенного имени. Для различия главному герою и его команде задаются цвета синих оттенков, а стороне антагониста 
оттенки красного цвета.

### Переходы

Ранее в этой книге мы уже познакомились со стандартными переходами в Ren’Py (например, _затухание_, _растворение_, 
_пикселизация_), но иногда нужно создать переходы с индивидуальными параметрами. Добавим два таких перехода в скрипт 
игры. Первый это _"slideleft"_ - слайдер в лево, который выполняет переход в течении двух секунд. Второй _"fireflash"_ -
вспышка, который представляет собой переход к ярко-оранжевому цвету и обратно. Он будет использоваться для сцен пожара. 

```python
define slideleft = CropMove(2.0, "slideleft")
define fireflash = Fade(0.1, 0.0, 0.5, color="#e40")
```

### Изображения для персонажей

На лаунчере Ren’Py в раздел _"Открыть папку"_ есть ссылка _images_. После её нажатия откроется каталог с изображениями 
проекта.

Чтобы назначить изображение персонажу, нужно выполнить следующие правило: имя файла с изображением должно совпадать с 
именем константы, в которой храниться персонаж. Например, в нашем случае нужно добавить изображения с именами _reg.png_, 
_merv.png_, _roy.png_ и так далее. Так же файл с именем _Reg.png_ соответствует _reg.png_ и будет присвоен персонажу, 
но файл с именем _Reginald.png_ уже не подойдёт.

Нужно не забывать, что Ren’Py для персонажей использует формат изображения PNG и WEBP, а для фона JPG, PNG и WEBP.

### Подготовка ассетов

Хоть Ren’Py на основе имени автоматически подгружает изображения персонажей, то остальные аудиовизуальные ресурсы нужно 
явно определить в файле скрипта. Как мы увидим позже большая часть ресурсов в создаваемой игре это фоновые изображения 
в формате jpg, которым присвоены соответствующие имена.

Единственным исключением является персонаж Рейн. В определённый момент игры её лицо становится серьёзным. Для этого мы 
дополнительно загружаем изображение выполнив следующую команду:

```python
image rai serious = "rai_serious.png"
```

Теперь для вывода персонажа Рейн с серьезным выражением лица нужно выполнить команду _rai serious "Да, я серьезно!"_. 
На основе данного приёма сделайте своих персонажей более живыми используя как можно больше изображений с различными 
эмоциями лица.

Помните, вы можете использовать оператор image для определения как основного портрета персонажа (например, 
_image jimmy = "jimmy.png"), так и для дополнительных (например, _image jimmy happy = "jimmyhappy.png"_). Однако перед 
этим вам нужно определить персонажа (например, _define jimmy = Character("Jimmy")_), что мы и сделали в главе 
_"Настройка персонажей"_.

Теперь давайте определим ассеты для офиса, которые можно скрывать и показывать при помощи команд _hide_ и _show_ 
(например, чтобы показать изображение офиса _office1_.jpg, нужно выполнить команду: _show office_, а чтобы скрыть 
выполнить команду: _hide office_)

```python
image office = "office1.jpg"
image office2 = "office2.jpg"
image email = "email.jpg"
image topfloor = "topfloor.jpg"
image cooler = "cooler.jpg"
```

Далее назначим изображения для сцен города, парка, станции и т.д.:

```python
image london = "london.jpg"
image london2 = "london2.jpg"
image park = "park1.jpg"
image park2 = "park2.jpg"

image alley = "alley.jpg"
image door = "door.jpg"
image window = "window.jpg"

image station = "station.jpg"
```

В конце, определим четыре изображения для огня, которые будут отображаться в случайном порядке, чтобы показать хаос 
пожара.

```python
image fire1 = "fire1.jpg"
image fire2 = "fire2.jpg"
image fire3 = "fire3.jpg"
image fire4 = "fire4.jpg"
```

### В бой!

Теперь мы приступим к написанию основного сценария. Укажем кто мы и чем занимаемся. Для этого отобразим портрет главного 
героя в точке с координатами xpos: 0.7 и ypos: 0.2, где значение 0.0 – это левый край, а 1.0 правый. Так же применим 
ранее определённый эффект скольжения.

Но сначала зададим следующие переменные, которыми воспользуемся позже.

```python
# Начало игры

label start:

# Определяем переменные

    $ sips = 0
    $ time = 0
    $ items = []
    $ dvd_found = False
```

При написании скрипта, не забывайте корректно задавать отступы для блоков кода.

Далее вставляем пустую строку и прописываем щелчки мыши:

```python
    play sound [ "<silence 1.5>", "sounds/mouse_clicks.wav" ]
```

Данная строка найдет в каталоге со звуками файл "sounds/mouse_clicks.wav" и воспроизведёт его с паузой в 1,5 секунды.

```python
    show office1
    with slideleft
```

Теперь отобразим фон офиса с именем _office1_ используя ранее определённый переход _slideleft_. Эти две строки должны 
иметь одинаковый отступ иначе при запуске игры возникнет ошибка. Чтобы с отступами было меньше проблем, то лучше 
использовать более продвинутые текстовый редактор, которые позволяет делать отступы при помощи кнопки Tab.

```python
    show reg:
        xalign 0.0
        xpos 0.7
        ypos 0.2
    with easeinleft

    "Рон Легион-Смерти, правительственный эксперт по кибербезопасности, бездельничал за своим рабочим столом."

    "Вместо работы над проектом, он смотрел смешные видеоролики в интернете."

    "Рон находился в депрессии из-за смерти своего лучшего и единственного друга по офису Мервина Попплуэлла."
```

В результате после запуска игры будет отображено стартовое меню. После нажатия _"Начать"_ начнётся повествование 
истории, появится изображение офиса и портрет главного героя. Если после нажатия _"Запустить проект"_ и в игре не 
появились внесённые изменения, то вероятно не был сохранен файл сценария игры.

### Комментирование кода

Хорошим тоном написания сценария – это его комментирование, особенно когда вы работаете в большой команде. В Ren’Py – 
это делается с помощью символа хэштега (#).

Например, добавьте данный комментарий перед появлением портрета главного героя с текстом "Рон Легион-Смерти, 
правительственный…".

```python
# Комната 1: Рабочий стол Рона
```

Хоть Ren’Py имеет строгие правила к отступам, но они не распространяется на комментарии, которые не являются частью 
кода.

### Ваше первое меню

Теперь мы при помощи меню реализуем взаимодействие пользователя с игрой.

Однако сперва для работы меню нужно определить переменные после метки "start". Чтобы это сделать используйте следующий 
синтаксис: _$ variable_name = 0_, где _variable_name_ – имя переменной.

```python
label start:
    $ sips = 0
    $ time = 0
    $ items = []
```

Как видим, инициализируется три переменных: _sips_ – которая используется для подсчета количества сделанных глотков воды 
главным героем, переменная _time_ будет подсчитывать количество проведённого времени, а переменная _items_, которая 
является пустым массивом, будет хранить в себе инвентарь. Однако Ren’Py не имеет массивов как таковых, вместо этого он 
использует _списки_.

Добавим следующий код в конец основного скрипта:


```python
    menu deskaction:
     "Выбери действие"
     "Посетить зону с питьевым фонтанчиком":
         $ time += 1
         stop sound fadeout 1.0
         hide office1
         show cooler
         with dissolve
         jump drinkingfountain
         
     "Осмотреть рабочий стол коллеги":
         $ time += 1
         stop sound fadeout 1.0
         hide office1
         show office2
         with dissolve
         jump neighboringdesk

    menu drinkingfountain:
             "Выбери действие"
             "Вернуться к своему рабочему столу":
                 jump deskaction
                 
             "Выпить":
                 $ sips += 1
                 
                 "Сделано глотков [sips]."
                 jump deskaction

    label neighboringdesk:
           if time>3:
               jump emailreceived

           if time<=2:
               "Коллег ушел рано. Его рабочий стол пуст."
               hide office2
               show office1
               with dissolve
               show reg
               jump deskaction
           else:
               "Соседний рабочий стол убран."
               hide office2
               show office1
               with dissolve
               show reg
               jump deskaction
```

В данном коде для создания меню используются такие ключевые слова как _menu_, _jump_ и _label_. Каждое меню должно иметь 
метку, в нашем случае это _deskaction_. А сочетание слов jump (прыжок) и label (метка) позволит выполнит переход по 
самому меню, и переход в нужную точку сценария. Так же обратите внимание, как используется знак двоеточия в конце меток 
и пунктов меню.

При выборе пункта меню «Выпить», над переменной выполняется операция +=, а потом она выводится в строке через квадратные 
скобки. Таким образом мы подсчитываем сколько Рон сделал глотков воды пока находился возле фонтанчика с водой. Каждое 
такое действие увеличивает количество глотков на единицу, но если нужно сделать 60 глотков, то строка имела бы вид 
_$ sips += 60_.

### Использование условного оператора

Благодаря условному оператору _if_, _elif_ и _else_ игру можно сделать более разнообразной и интересной. Для этого 
замените код от строки _menu drinkingfountain:_ до _jump deskaction_ на следующий: 

```python
    menu drinkingfountain:
             "Выбери действие"

             "Вернуться к своему рабочему столу":
                 jump deskaction

             "Выпить":
                 $ sips += 1
                 play sound "sounds/gulp.wav"

                 if sips<3:
                     "Сделано глотков [sips]."
                     show office1
                     with dissolve
                     jump deskaction
                 elif sips==3:
                     "После [sips] глотков, вы утолили жажду."
                     show office1
                     with dissolve
                     jump deskaction
                 else:
                     "Пропало желание пить."
                     show office1
                     with dissolve
                     jump deskaction
```

Как видим благодаря условному оператору мы проверяем переменную _sips_ и в зависимости от количества глотков сообщаем, 
что Рон утолил жажду. Условный оператор состоит из самого условия, которое прописывается после слова _if_, ключевого 
слова _elif_ (если ещё), который используется для проверки дополнительных условий, и слова _else_, код после которого 
будет выполняться если ни одно из условий не выполнено.

Теперь давайте добавим еще условие, на основе переменной _time_. Для этого внесём изменения в код меню _deskaction_:

```python
     "Посетить зону с питьевым фонтанчиком":
         $ time += 1
         jump drinkingfountain
         
     "Осмотреть рабочий стол коллеги":
         $ time += 1
         jump neighboringdesk
```

Далее добавим условный оператор после строки _label neighboringdesk_:

```python
           if time>3:
               jump emailreceived
```

Этот код просто проверяет количество выполненных действий в игре, и когда число больше трёх, мы переходим к метке 
_emailreceived_.

Теперь сменим декорации. Добавьте следующие строки кода после _jump deskaction_:

```python
    # Время электронной почты
    label emailreceived:
        scene email
        with dissolve
```

При помощи команды scene очищаем сцену от всех отображаемых объектов (т. е. фон и спрайты персонажей), и взамен 
показываем новый фон. После чего уведомляем игрока звуком колокольчика о получении электронного письма.

```python
        play sound "sounds/email.wav"

        "Рон вернулся к своему рабочему столу, и замечает, что ему пришло письмо."
        "Оно содержало следующее сообщение: \"Встретимся сегодня в семь вечера в Парке возле Aрки. Никому не говори об этой встречи …\""
        "... и подписано Мервин Попплуэлл."
        "Это какая-то шутка. Мервина же больше нет."
        "Рон решает позвонить Ройстону сотруднику из технической поддержки, чтобы узнать, кто прислал это письмо."
        "После телефонного звонка, выясняется, что письмо настоящее, и Ройстон просит Рона подняться на верхний этаж."
```

Согласно повествованию, следующее место действия – это верхний этаж.
В этой сцене так же используется условный оператор. Будет выполнена проверка переменной sips, чтобы узнать, немного ли 
выпил игрок воды, и если да, то отобразить шутливое сообщения.

```python
label topfloor:

    scene topfloor
    with dissolve

    # Показываем изображение телефона
    show phone:
        xalign 0.0
        xpos 0.5
        ypos 0.18
    with easeinleft
```

Кроме изображений фона и персонажей Ren’Py может отобразить любой другой спрайт. Если посмотреть пример предыдущего 
кода, то сценарий выводит спрайт мобильного телефона используя эффект _easeinleft_. Далее отображается диалог, а затем 
телефон исчезает с эффектом _easeoutright_.

```python
    "Там Рон находите мобильный телефон 80-х годов, и забирает его с собой."

    hide phone
    with easeoutright
```

Теперь реализуем инвентарь. Используя метод _append_, добавим первый элемент инвентаря - мобильный телефон, и подадим 
специальный сигнал игроку.

```python
    play sound "sounds/sound.wav"
    $ items.append("специальный телефон")

    scene london
    with dissolve

   # Если игрок выпил слишком много воды, показываем сообщение
    if sips >= 3: 
        "Нужно сходить в туалет."
    "Он всё же решается на встречу, предложенную в электронном письме."

   # Парк
    label hydepark:
    play music [ "sounds/park.mp3" ] fadein 10.0 loop
```

Возможно, вы помните Ren’Py по умолчанию имеет три звуковых канала: _sound_, _music_, и _voice_. Как видим, предыдущие 
строки кода демонстрируют нам использование музыкального канала. Мы циклично (_loop_) воспроизводим с нарастанием 
(_fadein_) в 10.0 секунд фоновые звуки парка. 

```python
    scene park
    with dissolve

    "Парк находился всего в нескольких минутах ходьбы от офиса. Идя по дороге к арке парка"
    $ items.append("монета")  

    # Сортируем список элементов
    $ items.sort()

    play sound "sounds/sound.wav"
    "Рон замечаете монету в земле. Он поднял ее и положил в карман."
```

Для сохранения инвентаря мы использовали пустую переменную _items_ и походу игры используя метод _.append_ добавили виде 
строки два предмета _монету_ и _специальный телефон_. Как использовать данный список мы узнаем позже, но самый простой 
пример — это проверять наличие ключа у игрока для открытия двери.

Чтобы упорядочить инвентарь в списке отсортируем его в алфавитном порядке при помощи метода _sort_.

### Настройка скорости текста

По умолчанию Ren’Py показывает диалог персонажа одним блоком. Если вы хотите использовать классический эффект печатной 
машинки, нужно открыть файл options.rpy и найти строку _default preferences.text_cps = 0_. Далее, ноль заменить на 20, 
после чего сохранить файл и перезапустить игру.

### Обновляем систему инвентаря

Чтобы игрок не записывал найденные вещи на бумаге, реализуем интерфейс для отображения инвентаря. Добавим следующий код 
в скрипт, где оператор _init_ позволит его выполнить в первую очередь.

```python
init python:
    items = []
    def display_items_overlay():
        if len(items)>0:
            inventory = "Инвентарь: "
            for i in range(0, len(items)):
                item_name = items[i].title()
                if i > 0:
                     inventory += ", "
                inventory += item_name
            ui.frame()
            ui.text(inventory)
    config.overlay_functions.append(display_items_overlay)
```

В результате код выведет список предметов инвентаря в верхнем левом углу экрана.

В коде при помощи оператора _python_ указывается, что далее идут строки, которые нужно интерпретировать как чистый 
Python. То есть язык, на котором написан сам Ren’Py. После чего определяем список с названием _items_. Далее проверяем 
если _items_ содержит хоть один элемент, то выводим содержимое через запятую. Данный процесс будет выполниться в фоновом 
режиме на протяжении всей игры.

На будущее, для манипуляции с элементами в списке существуют различные методы, с которыми вы можете ознакомиться в 
Таблице 7-15.

__Таблица 7-15.__ Методы для манипуляции со списками в Python и Ren’Py

| Метод     | Описание                                              | Пример                           |
|-----------|-------------------------------------------------------|----------------------------------|
| _append_  | Добавить элемент в список                             | fruit.append("apple")            |
| _remove_  | Удалить элемент из списка                             | pocket.remove("pie")             |
| _insert_  | Вставляет элемент в заданную позицию                  | inventory.insert(2, "deodorant") |
| _reverse_ | В списке выставляет элементы в обратном порядке       | names.reverse()                  |
| _count_   | Подсчитывает количество элементов, найденных в списке | fruit.count("Pear")              |
| _sort_    | Сортирует элементы в алфавитном порядке               | last_names.sort()                |
| _clear_   | Удаляет все элементы из списка                        | inventory.clear()                |
| _len_     | Возвращает количество элементов в списке              | if len(items)>0:<br> "Hooray!"   |


Продолжим создавать игру добавив следующий код после строки _$ items.append("coin")_:

```python
    scene park2
    with dissolve

    "Возле Арки парка никого не было."
    "Рон довольно долго ждал, но никто так и не пришел."
    "Разочаровавшись, он отправился домой."
```

Теперь продолжим сценарий драматической сценой - пожаром в офисе:

```python
    # Офис Инферно
    label inferno:

    "На обратной дороге Рон замечает, что горит его офис."
    reg "Если бы я задержался немного на работе перед тем, как пойти в парк, то может быть предотвратил пожар."
    play sound "sounds/phone.wav" loop

    "В этот момент из портфеля послышался звук звонящего телефон. Взволнованный Рон с трудом достаёт его и отвечает на звонок."

    stop sound
    show roy:
        xalign 0.0
        xpos 0.2
        ypos 0.2
    with easeinright

    roy "Спаси розовый DVD-диск. У тебя осталось около десяти минут, прежде чем его поглотит огонь."

    hide roy
    play sound "sounds/siren.wav" fadein 5.0 fadeout 5.0

    "Речь шла про систему безопасности «Август», которую должны интегрировать во все государственные службы страны. "
```

### Добавляем функции

Функции — это многократно используемый код. Они так же приводят код в порядок и ускоряют процесс разработки. В Ren’Py 
функции вызываются при помощи команды _call_.

Перед тем как познакомится с функциями, добавим после строки _label start:_ переменную _$ dvd_found = False_, чтобы 
запомнить есть ли у вас DVD-диск или нет. Это _логическая переменная_ и может иметь только два значения: истина (True) 
или ложь (False). 

> Примечание:
> 
> Ren’Py требователен к значениям переменных логического типа, которые должны начинаться с заглавной буквы (т. е. 
> _True_ — это правильно, а _true_ вызовет ошибку).

Теперь определим три функции перед меткой _label start:_.

```python
label show_fire:
    $ num = renpy.random.randint(1, 4)
    $ which = "fire" + str(num)
    show expression which
    with fireflash
    return

label check_dvd:
    # воспроизвести звук если dvd_found не равно True
    if dvd_found == False:
      play sound "sounds/sound.wav"
    $ if dvd_found == False: items.append("DVD-диск")
    $ if dvd_found == False: items.sort()
    $ if dvd_found == False: dvd_found = True
    return

label checktime:
    # вызываем функцию show_fire из этой функции
    call show_fire

    play sound "sounds/woosh.wav"
    $ time -= 5
    if time < 5:
      jump burn
    return
```

Первая функция _show_fire_ используется для случайного выбора фона из четырех изображений. Для этого в переменную _num_ 
помещается случайное число от одного до четырех. Затем это число преобразовывается в строку и добавляется к строке 
_fire_. После чего передаём ее команде show, преобразовав оператором _expression_ в исполняемую строку. В результате с 
эффектом _fireflash_ (определённый ранее) отобразиться фон с огнём.

Вторая функция _check_dvd_ сперва проверяет, равно ли значение переменной dvd_found False. Если это так, то элемент 
добавляется в инвентарь с помощью метода append, а сам список сортируется в алфавитном порядке. В конце, переменной 
dvd_found присваивается значение True, для избежания повторного добавления DVD-диска в инвентарь.

Для третей функции _checktime_ понадобиться ранее используемая переменная _time_, со значением 25. Не бойтесь, в 
программировании повторное использование переменных вполне нормальная практика.

В эпизоде, где игрок лихорадочно ищет DVD-диск в офисе охваченным огнём имеется четыре комнаты (т. е. 
_Помещение офиса - officefire_, _Рабочий стол Рона - firedesk_a_, _Соседний стол А - firedesk_b_, 
_Соседний стол Б - firedesk_c_). А искомый диск находиться на рабочем столе коллеги _firedesk_c_, но игрок об этом не 
знает. Вот здесь и будет использоваться функция _checktime_, которая при каждом переходе между столами будет сокращать 
переменную time на 5 секунд, а как только время достигнет нуля, то функция выполнить переход к сцене гибели игрока 
в огне.

Чтобы перейти к созданию данного эпизода нужно ещё добавить сцену с переулком, где указываем значение для переменной 
time:

```python
    # В Аду
    label actionscene:

    scene alley
    with dissolve

    play music [ "sounds/fireplace.mp3" ] fadein 10.0 loop

    "Оказавшись возле офиса, Рон, недолго думая, взбирается по пожарной лестнице."
    $ time = 25

    call show_fire
```

### Система частиц с SnowBlossom

Главный герой попадает в огненный ад, а огонь как мы знаем сопровождается искрами. Давайте добавим такой эффект 
используя _систему частиц_. Где сама частица — это маленькое изображение (спрайт), а используя большое количество таких 
частиц, можно создать эффекты как дождь, снег и взрыв. Для этого в Ren’Py существует встроенный объект SnowBlossom. Он 
часто используется в визуальных новеллах для реализации падение листвы с дерева или лепестков цветущей сакуры, но мы 
применим данный эффект для создания анимации искр огня.

```python
    # Добавляем и настраиваем эффект летящих искр с помощью SnowBlossom
    image sparks = Fixed(
        SnowBlossom(im.FactorScale("images/fireparticle.png",1.0),count=12,start=5),
        SnowBlossom(im.FactorScale(im.Alpha("images/fireparticle.png",0.8),0.6),count=15,yspeed=(50,125)))
```

Основные параметры SnowBlossom это _count_, _start_, _yspeed_ и _xspeed_. Параметр start задаёт в секундах задержку 
появления новых частиц. Сейчас данный параметр равен 5 секундам. Параметр count задаёт количество частиц.

Далее параметр yspeed задает скорость по вертикали, а xspeed задает скорость по горизонтали. Значение этих атрибутов, 
может быть, как отрицательные, так и положительные, и состоять из одного числа или кортежа (например _(5,10)_ или 
_(-10,-5)_). При использовании в Ren’Py кортежей, то значение для параметра будет выбрано случайно из указанного 
диапазона чисел. В нашей игре искры должны падать довольно медленно, для этого зададим скорость от 50 до 125.

Так же видно, что в коде используется два экземпляра SnowBlossom. Первый создаёт полноразмерные частицы, а второй 
уменьшенный вариант этих частиц. Так же во втором варианте через параметр _im.Alpha_, который равен 0,6, указывается 
альфа-канал, делающий искры огня полупрозрачными. Благодаря этому достигается иллюзия глубины.

Так же можно использовать более упрощенный вариант эффекта SnowBlossom:

```python
  image sparks = Fixed(
       SnowBlossom(im.FactorScale("images/fireparticle.png",1.0), count=10, yspeed=(100,110), xspeed=(1,2), start=4))
```

Но такой код создаст просто красивый эффект снега, но нам нужны более реалистичные искры, поэтому оставим предыдущий код.

Далее активизируем частицы при помощи команды show:

```python
    show sparks

    menu officefire:
     "Выбери действие. У вас осталось [time] секунд. Вы находитесь в помещении офиса."
     "Подбежать к своему рабочему столу":
         call checktime
         jump firedesk_a

     "Подбежать к столу коллеги":
         call checktime
         jump firedesk_b

     "Подбежать к столу другого коллеги":
         call checktime
         call check_dvd
         jump firedesk_c
```

После чего игрок видит меню из трёх пунктов. Сделав выбор, вызывается функция _checktime_, которая уменьшает оставшееся 
время на пять единиц. Если значение времени станет ниже пяти, то функция перенесет игрока к метке _burn_ окончания игры. 
В этой части кода хорошо показано, как вынесенный повторяющийся код в функцию сокращает его размер.

Когда игрок попадает в комнату с DVD-диском (_firedesk_c_), то выполняется функция _check_dvd_, которая добавить диск к 
инвентарю, и отметит, что он найден.

```python
    menu outwindow:
     "Выбери действие. У вас осталось [time] секунд. Вы находитесь в помещении офиса."
     "Вылезти через окно":
         call checktime
         jump window

     "Подбежать к своему рабочему столу":
         call checktime
         jump firedesk_a

     "Подбежать к столу коллеги":
         call checktime
         jump firedesk_b

     "Подбежать к столу другого коллеги":
         call checktime
         call check_dvd
         jump firedesk_c
```

Для комнаты _"Помещение офис"_ создаётся два почти идентичных меню. Первое это _officefire_ переход, к которому 
выполняться при _dvd_found_ равно False. Второе меню _outwindow_ с дополнительным пунктом _"Вылезти в окно"_, выведется 
если переменная _dvd_found_ будет равна True. Другими словами, возможность покинуть охваченный огнём офис через окно, 
появляется, когда игрок найдет DVD-диск посетив комнату _firedesk_c_, а потом вернется в комнату _"Помещение офис"_.

```python
    menu firedesk_a:
     "Выбери действие. У вас осталось [time] секунд. Вы находитесь возле своего рабочего стола, но здесь нет DVD-диска, только пламя."

     "Вернуться в помещение офиса":
         call checktime
         if dvd_found == False:
              jump officefire
         else:
              jump outwindow

     "Подбежать к столу коллеги":
         call checktime
         jump firedesk_b

     "Подбежать к столу другого коллеги":
         call checktime
         call check_dvd
         jump firedesk_c

    menu firedesk_b:
     "Выбери действие. У вас осталось [time] секунд. Вы находитесь возле стола своего коллеги, но здесь нет DVD-диска, только дым."

     "Вернуться в помещение офиса":
         call checktime
         if dvd_found == False:
              jump officefire
         else:
              jump outwindow

     "Вернуться к своему рабочему столу":
         call checktime
         jump firedesk_a

     "Подбежать к столу другого коллеги":
         call checktime
         call check_dvd
         jump firedesk_c
```

Так. Комнаты _firedesk_a_ и _firedesk_b_ добавлены, осталось добавить комнату с DVD-диском:

```python
    menu firedesk_c:
     "Выбери действие. У вас осталось [time] секунд. Вы находитесь возле стола другого коллеги."

     "Вернуться в помещение офиса":
         call checktime
         if dvd_found == False:
              jump officefire
         else:
              jump outwindow

     "Подбежать к своему рабочему столу":
         call checktime
         jump firedesk_a

     "Подбежать к столу коллеги":
         call checktime
         jump firedesk_b
```

В случае если наш главный герой погибает, но он при этом успел найти диск, то мы, используя условный оператор, отобразим 
дополнительный диалог:

```python
label burn:
    "Задыхаясь от дыма, вы теряете сознание и сгораете заживо."
    if dvd_found == True:
        "В результате после пожара спасатели обнаружили труп с DVD-диском в руках."

    # Возвращаемся в главное меню
    $ renpy.full_restart()
```

После этого используя метод _full_restart_ сбрасываем игру, отобразив игроку главное меню. Игра окончена!

Теперь вставим код, когда главный герой успешно находит DVD-диск и спасается от огня:

```python
label window:
    "В конце концов вы находите спасение выбравшись из офиса через окно и спустившись по пожарной лестнице!"
```

### Случайный диалог

Давайте добавим в историю случайные диалоги, чтобы разнообразить игру.

```python
    $ randomdialogue = renpy.random.choice(['Телефон в портфеле снова зазвонил.', 'Из портфеля раздался пронзительно громкий звук.', 'Зазвонил старый мобильный телефон.'])

    play sound "sounds/phone.wav" loop

    # Отображаем случайный диалог
    "[randomdialogue]"

    stop sound
    show roy:
        xalign 0.0
        xpos 0.2
        ypos 0.2
    with dissolve

    roy "Молодец. Теперь иди домой и жди дальнейших указаний. Если необходимо, защити диск ценой своей жизни."
```

В данной части кода используя переменную randomdialogue строка _"[randomdialogue]"_ выводит одну из трех строк, 
хранящихся в переменной _random_narration_.

То есть если нам понадобиться получить и вывести случайное значение, нужно написать приблизительно следующие строки:

```python
    # Генерируем случайное число от 20 до 80
    $ random_number = renpy.random.randint(20, 80)

    "Вы в мотивированы на [random_number]%%, чтобы продолжить квест!"
```

Здесь мы инициализируем переменную _random_number_, и присваиваем ей значение от 1 до 100. Далее выводим её в диалоге 
игры. Однако нам нужно отобразить символ _%_, а это зарезервированный символ, для этого заменим его на запись _%%_, 
иначе Ren’Py выдаст ошибку.

А если потребуется сгенерировать случайное значение с плавающей запятой от 0 до 1 (например, _0,5_ или _0,9_), то нужно 
воспользоваться методом _renpy.random.random()_.

### Стили и гиперссылки

Сценарий этой маленькой игры заканчивается следующим образом:

```python
label home:

    scene london2
    with dissolve

    # Мы используем музыкальный канал для воспроизведения фона, так как он
    # позволяет зациклит и применить затухание к аудио дорожке.
    play music [ "sounds/london_bridge.wav" ] fadein 10.0 loop

    "Чем ближе Рон становился к дому, тем спокойней себя чувствовал." 

    play sound "sounds/phone.wav" loop

    "Телефон снова зазвонил."
    stop sound

    "Ответив, он услышал женский голос."
   
    # Показываем Рейн с серьёзным лицом
    show rai serious:
        xalign 0.0
        xpos 0.2
        ypos 0.2
    with dissolve
```

Как видим, код выводит диалоги без форматирования. В конце, командой _show rai serious_, изменяем лицо Рейн на 
серьёзное, которое было определено ещё в начале сценария.

```python
    rai "{i}Ни в коем случае, не возвращайтесь домой!{/i} Покинь город прямо {u}сейчас.{/u} Сядь на поезд, и уезжай на север."
    rai "Главное не задерживайся! Чуть позже я тебе перезвоню. {b}И не потеряй диск!{/b}"
```

Следующая часть кода сменяет лицо Рейн на дерзкое, оно является лицом по умолчанию. Напомним, что если команда show 
применяется без каких-либо параметров, то будет показано изображение персонажа по умолчанию (например, _rai.png_, 
_roy.png_ и _reg.png_).

```python
    # Меняем лицо Рейн с серьёзного на дерзкое
    hide rai
    show rai:
        xalign 0.0
        xpos 0.2
        ypos 0.2
```

В предыдущих диалогах мы применили к тексту три стиля: жирный, курсив и нижнее подчеркивание. Для этого строки 
оборачиваются в специальные теги состоящий из фигурных скобок с символом нужного стиля внутри (например, _{u}_). Но 
помните, используйте форматирование с умом, чтобы текст был легко читаем.

Теперь, давайте вставим немного рекламы в виде гиперссылки в диалоге.

```python
    rai "О, когда будет свободное время, посетите {a=https://www.example.com}этот сайт{/a}."
```

Как видим гиперссылки в Ren’Py встраиваются при помощи тега _a_, и после символа равно указывается ссылка на ресурс.

Если нужно изменить размер текста, то воспользуйтесь тегом _size_. Пример его использования, а также как можно 
комбинировать теги, показано в следующем коде.

```python
    rai "Я каждый день на нём нахожу что-то новое. Он очень {size=+10}{i}увлекательный{/i}{/size}."
    hide rai

    # Заменяем фоновый звук на другой 
    play music [ "sounds/ambience.wav" ] fadein 10.0 loop

    # Музыкальный канал отлично подходит и для создания атмосферного фона, 
    # и для воспроизведения аудио с определёнными параметрами.
```

### Добавляем видео

Воспроизвести видео в Ren’Py очень просто. Достаточно написать на языке Python _renpy.movie_cutscene_ и передать путь к 
видеофайлу. Будьте внимательны к регистру символов и правильности пути к файлу, иначе Ren’Py выдаст ошибку. Что касается 
формата видео контейнера для проектов Ren’Py самым популярным является WebM.

```python
    $ renpy.movie_cutscene("videos/Interlude.webm")
    scene door
    with dissolve
```

>Примечание:
> 
> Большинство видеоредакторов не поддерживают экспорт в формат WebM. Для этих целей может потребоваться установить 
> дополнительный плагин. Как альтернатива, можно экспортировать видео в любом доступном формате, а затем используя 
> сторонне программное обеспечение конвертировать видеофайл в WebM.

### Скорость текста на лету

Подобный эффект пишущей машинки мы уже рассматривали ранее в этой главе. Для этого нужно было внести изменения в файл 
_options.rpy_. Хотя данный эффект применяется глобально, но мы можем на него повлиять локально из самого скрипта игры.

```python
    "Оказавшись возле своей квартиры, Рон услышал странные звуки. Чтобы понять что там происходит, он приложил ухо к двери, {cps=5}но звук стал только громче.{/cps}"
```

Для этого используется тег _cps_, где после знака равно указывается скорость печати текста. Используйте данный эффект, 
когда нужно добавить больше драматичности тексту повествования.

### Живой текст

Ren’Py имеет множество тегов для стилизации текста в диалоге игры.

```python
    "{k=-1.5}Что-то не так.{/k} {k=1.5}Рон вспомнил совет девушки и ушел прочь.{/k}"
    "Он направился на вокзал. По дороге случайно оглянулся назад, и{vspace=25}{w}заметил, что за ним следует человек."
```

В данном фрагменте сценария демонстрируется _эффект кернинг текста {k}_, 
_вертикальное пространство между строками {vspace}_ и _ожидание {w}_. Кернинг устанавливает отступ между символами. 
Может иметь как отрицательное значение (приблизить символы), так и положительное (отдалить символы).

Тег _vspace_ добавляет вертикальное пространство между строками размером равное указанному параметру в пикселях. Тег 
ожидания просто ждет щелчка мыши, чтобы продолжить повествование.

```python
    "С неестественно большими глазами, одетый в голубой комбинезон. Он выглядел как-то не естественно, хоть и имел фигуру человека. {fast} От него тянуло страхом, что аж замирало сердце."
```

Тег _fast_ мгновенно, в соответствии с настройками в файле параметров Ren’Py, отображает текст, который идет перед ним.

```python
    scene station
    with dissolve
    stop music fadeout 5.0

    "Рон побежал. Остановился только возле вокзала, задыхаясь и кашляя. Он надеялся, что оторвался от преследователя."
    "Следуя совету Рейн, Рон направился взять билет на ближайший поезд, который идет на север."
    "Вот мы и достигли конца учебной визуальной новеллы на Ren’Py."
```

Вот и подошла к концу первая часть "Август возвращается". Вы познакомились с основными возможностями Ren’Py, и в 
результате создали игру. Если вам хочется завершить данный проект, то придётся это сделать самостоятельно, а мы 
продолжим разрабатывать игру на следующем движке.

## Часть II: Основная часть истории Рона на TyranoBuilder

Чтобы продолжить историю _"Август возвращается"_, мы погрузимся в мир TyranoBuilder с его графическим интерфейсом, и для 
начала создадим новый проект.

После ввода названия укажем:

* Game Type (Тип игры): _Visual Novel (Визуальная новелла)_
* Screen Size (Размер экрана): _Landscape (1280 x 720) (Альбомный (1280 x 720))_
* Game Settings (Настройки игры):  _убрать галочки с No Title Screen (Без заголовка экрана) и No Menu Button (Без кнопок 
меню)_

На последнем шаге нажимаем кнопку _Create New Project (Создать новый проект)_.

В созданном проекте выберите _Background Image (Фоновое изображение)_ и удалите его, нажав на крестик удаления.

### Персонажи

Для повествования нам нужны персонажи. Для этого в меню выберите _Project\Characters_ (_Проект\Персонажи_). В 
появившемся окне _Characters_ (_Персонажи_), при помощи поля ввода _Character Name_ (_Имя персонажа_) добавим следующих 
персонажей: _Клэр_, _Человек в комбинезоне_, _Рон_ и _Рейн_. TyranoBuilder автоматически создаст в каталоге 
_ProjectName/data/fgimage_ пронумерованные подкаталоги для персонажей (например, 1 – это Клэр, 2 – это Человек в 
комбинезоне и так далее), в которых будут сохранены связанные с ними изображения.

### Поезд

Продолжим историю. Наш отважный главный герой оказался возле поезда. Теперь скопируйте следующий текстовый блок и 
ставьте его в красное поле _"Text (Текст)"_ под _"Show Text (Показать текст)"_.

```
Рон побежал. Остановился только возле вокзала, задыхаясь и кашляя. Он надеялся, что оторвался от преследователя.
Следуя совету Рейн, Рон направился взять билет на ближайший поезд, который идет на север.
```

Далее следует еще один фрагмент повествования для второго компонента Show Text:

```
"Извините!" — кто-то обратился к Рону. Темноволосая девушка возникла из не откуда, заблокировав проход в вагон. "Это 
поезд на север?" - улыбаясь спросила она.
```

Как видим, TyranoBuilder предлагает удобный графический интерфейс для создания визуальных новелл. Однако нужно не 
забывать о мощном компоненте TyranoScript, который имеет больше возможностей для разработки. Соответственно эта часть 
игры и будет в основном создана на данном компоненте.

### Ассеты и каталоги

TyranoBuilder использует аудио, видео, изображения и другие файлы. Всё это он распределяет по специально выделенным 
каталогам, которые автоматически создаются для каждого проекта. Давайте с ними познакомимся. Так как TyranoBuilder в 
основном распространяется через Steam, то, чтобы открыть каталог с проектом нужно выполнить следующие действия:

* Найдите в библиотеке Steam приложение TyranoBuilder, на котором щелкните правой кнопкой мыши и выберите 
_"Properties (Свойства)"_.
* Откройте вкладку _"Local Files (Локальный файлы)"_.
* Нажмите на кнопке _"Browse Local Files (Просмотреть локальные файлы)"_

Откроется каталог программы TyranoBuilder. В котором находите и открываете каталог вашего проекта, после чего переходите 
в каталог _data_ (например, _myproject\nameproject\data_). В результате отобразится структура каталога, где хранятся все 
файлы игры, с описанием которых можно ознакомиться в таблице 7-16.

Есть и другой способ попасть в данный каталог. В TyranoBuilder выбираете пункт главного меню 
_"TyranoBuilder\Project List"_. Откроется список проектов, находите ваш проект и справой стороны от названия нажимаете 
на _иконку с изображением папки_.

__Таблица 7-16.__ Основные каталоги проектов TyranoBuilder (каталог "nameproject\data").

| Каталог    | Используется для                                      |
|------------|-------------------------------------------------------|
| _bgimage_  | Фоновых изображений                                   |
| _bgm_      | Фоновой музыки (в формате .ogg или .wav)              |
| _fgimage_  | Изображений персонажей. Создаются автоматически       |
| _image_    | Изображений, связанных с пользовательским интерфейсом |
| _others_   | Плагинов (т. е. установленные дополнения)             |
| _scenario_ | Файлов сцен (например, scene1.ks)                     |
| _sound_    | Звуковых эффектов (в формате .wav или .ogg)           |
| _video_    | Видеофайлов (желательно формат .webM)                 |

Одним из основных элементов игры является звуковое сопровождение. Для этого в TyranoScript используется специальный 
набор тегов (см. Таблицу 7-17). Чтобы программа понимала, что мы используем тег его оборачивают в квадратные скобки или 
используют знак @ в начале строки если тег не более одной строки (например, _@playse Storage=cheer.ogg_).

> Примечание:
> 
> Для комментариев в TyranoScript используют точку с запятой (;).

__Таблица 7-17.__ Теги для работы со звуком

| Тег            | Описание                                                                                                                               | Пример                                           |
|----------------|----------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
| _[playse]_     | Воспроизводит звук. Параметры loop и clear не обязательны. Повторный вызов останавливает воспроизведение предыдущего звукового эффекта | [playse storage=cheer.ogg loop=false clear=true] |
| _[stopse]_     | Останавливает воспроизведение звука                                                                                                    | [stopse]                                         |
| _[seopt]_      | Устанавливает громкость звука                                                                                                          | [seopt volume=70]                                |
| _[wse]_        | Ожидает завершения воспроизведения звукового эффекта                                                                                   | [wse]                                            |
| _[playbgm]_    | Воспроизводит фоновую музыку. Параметры: _loop_, _time_ (точка с которой начать воспроизведения в миллисекундах)                       | [playbgm storage="song1.ogg" loop=true]          |
| _[stopbgm]_    | Останавливает воспроизведение фоновой музыки                                                                                           | [stopbgm]                                        |
| _[bgmopt]_     | Устанавливает громкость фоновой музыки                                                                                                 | [bgmopt volume=50]                               |
| _[xchgbgm]_    | Подмешивайте одну музыку, пока другая затихает. Параметры: _loop_, _time_ (в миллисекундах)                                            | [xchgbgm storage=song2.ogg loop=true time=4000]  |
| _[fadeoutbgm]_ | Задает затухание фоновой музыки в миллисекундах                                                                                        | [fadeoutbgm time=3000]                           |
| _[fadeinbgm]_  | Задает затухание фоновой музыки в миллисекундах                                                                                        | [fadeinbgm time=5000]                            |

### Звуки в поезде

Продолжим наше приключение. Перетащите компонент _"Change Background (Изменить фон)"_ из категории 
"Images (Изображения)" и разместите его перед добавленным текстом. В свойствах компонента нажмите кнопку 
"Browse (Обзор)", после чего загрузите файл с именем _train2.jpg_. Затем добавьте компонент "TyranoScript" перед 
компонентом _"Exit Scene (Покинуть сцену)". Раскройте его, и вставьте следующий код:

```TyranoScript
;Используя переменную "f.rumlevel", устанавливаем уровень опьянения равный ноль
[eval exp="f.rumlevel = 0"] 
```

В строке **[eval exp="f.rumlevel = 0"]**, определяем переменную с именем _f.rumlevel_ со значением ноль. Напомним вам, 
что внутри игровые переменные в TyranoBuilder должны начинаться с _f._ (например, _f.happiness_, _f.attraction_level_). 
Теперь добавим в компонент ещё код:

```TyranoScript
;Тег [r] вставляет новую строку
Девушка вызывала, только сомнение. - «Да, поезд идёт на север» - ответил Рон и пройдя мимо неё заскочил в вагон. [r]
;Тег [l] ждет щелчок мыши от игрока, а тег [cm] убирает весь текст.
Найдя своё место, Рон сел, и поезд трогается с места. [l][cm]
;Воспроизводим циклично фоновый звук в вагоне и движущегося поезда
[fadeinbgm storage=train_01.wav loop=true time=3000]
;Показываем новый фон
[bg storage=train1.jpg time=6000 wait=true]
Девушка снова встретилась с Роном, так как оказалось их места находятся рядом.[l][cm]
Она представилась, что её зовут Клер, и извинилась, что снова создаёт ему неудобства.[l][cm]
Когда Клэр села, то надела наушники, и закрыла глаза.[r]
Это обрадовало Рона, теперь он может спокойно собраться с мыслями и подумать.[l][cm]
;Проигрываем видео (невозможно пропустить)
[movie storage=interlude.webm skip=false]
```

На основе комментариев к коду, становится ясно, что, используя тег _fadeinbgm_ в фоне плавно (нарастание звука 
происходит в течении 3000 миллисекунд) зациклено воспроизводиться шум поезда.

Также меняется фоновое изображение при помощи тега _bg_ с использованием 6-ти секундным эффектом плавного перехода. А в 
конце кода воспроизводится видео в формате webM.

TyranoBuilder имеет и другие теги для работы со слоями, текстом и изображениями см. Таблицу 7-18.

__Таблица 7-18.__ Теги для работы с текстом, слоями и изображениями.

| Тег              | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Пример(ы)                                                                                                                                                                                                                             |
|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| _[image]_        | Отображает изображение.<br>Параметры: _layer_, _page_, _visible_, _width_, _height_, _x_, _y_. <br>Если указать layer значение _base_, то изображение выведется как фон, а если указать число больше нуля, то изображение выведется на передний план.<br>Параметр page принимает значение только _fore_ или _back_.                                                                                                                                                                                                                                                                                                                                                                                                            | [image storage="dude.jpg" layer=1 page=fore visible=true width="256" height="256" x="640" y="200"]<br>[image storage="bg.jpg" layer=base page=back visible=true width="1280" height="720" x="0" y="0"]                                |
| _[bg]_           | Изменяет фон. <br>Параметры: _method_, time_, _wait_. <br>Параметр method принимает значение какой применить тип перехода (т. е. _crossfade, explode, slide, blind, bounce, clip, drop, fold, puff, scale, shake, size_).<br>Параметр wait указывает, следует ли останавливать обработку до завершения замены.                                                                                                                                                                                                                                                                                                                                                                                                                 | [bg storage=bg1.png method=slide time=2000 wait=true]<br>[bg storage=bg2.png method=puff time=4000 wait=false]                                                                                                                        |
| _[layopt]_       | Управляет отображением слоев.<br>Параметры: _page_, _visible_, _left_ (позиция слева), _top_, _opacity_ (имеет значение от 0 до 255, где 255 — полностью прозрачен).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [layopt layer=1 visible=true opacity=100]<br>[layopt layer=1 visible=false]                                                                                                                                                           |
| _[anim]_         | Анимирует или перемещает изображение или спрайт персонажа.<br>Необязательные параметры: _layer, left, top, width, height, opacity, color, time, effect_.<br>Параметр effect использует следующие значения: _jswing \| def \| easeInQuad \| easeOutQuad \| easeInOutQuad \| easeInCubic \| easeOutCubic \| easeInOutCubic \|easeInQuart \| easeOutQuart \| easeInOutQuart \| easeInQuint \| easeOutQuint \| easeInOutQuint \| easeInSine \| easeOutSine \| easeInOutSine \| easeInExpo \| easeOutExpo \| easeInOutExpo \| easeInCirc \| easeOutCirc \| easeInOutCirc \| easeInElastic \| easeOutElastic \| easeInOutElastic \| easeInBack \| easeOutBack \| easeInOutBack \| easeInBounce \| easeOutBounce \| easeInOutBounce_. | [anim name="Billy" time=3000 left=100 top=40]<br>[anim name="Reginald" time=2000 left=800 top=40 effect=easeInOutQuint]<br>[anim name="Gayelord" time=1000 left=100 top=40 effect=easeInOutQuint color=red opacity=50]                |
| _[ptext]_        | Отображает текст. Понимает HTML-теги.<br>Параметры: _text, size, x, y, color, vertical_.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [ptext layer=2 page=fore text="Привет \<br\>\<i\>друзья!\<\/i\>" size=30 x=30 y=180 color=green]                                                                                                                                      |
| _[mtext]_        | Отображает текст с анимацией. Имеет множество различных эффектов.<br>Параметры: _text, x, y, in_effect, out_effect_.<br>Демонстрацию в реальном времени можно посмотреть на [https://tyrano.jp/mtext/]( https://tyrano.jp/mtext/).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [layopt layer=0 visible=true]<br>[mtext text="Привет!" x=200 y=100 in_effect="fadeIn" out_effect="hinge"]<br>[layopt layer=0 visible=true]<br>[mtext text=" Ух ты! Что это?" x=200 y=100 in_effect="bounceIn" out_effect="bounceOut"] |
| _[filter]_       | Применяет фильтр к слою или объекту.<br>Параметры: _grayscale, sepia, saturate, hue, invert, opacity, brightness, contrast, blur_.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [filter layer="0" sepia=50]<br>[filter layer="0" invert]                                                                                                                                                                              |
| _[free_filter]_  | Отключает фильтры.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [free_filter]                                                                                                                                                                                                                         |
| _[movie]_        | Воспроизводит фильм в формате mp4.<br>Параметры: _skip_ (пропустить просмотр видео или нет).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | ;Показываем видео, которое нельзя пропустить<br>[movie storage="happymovie.mp4" skip=false]                                                                                                                                           |
| _[bgmovie]_      | Воспроизводит видео в фоне.<br>Параметры: _volume_, _loop_.<br>Примечание: желательно использовать формат видео webM.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ;Показать циклично видео с громкостью 80%<br>[bgmovie storage="movie.webm" volume=80 loop=true]                                                                                                                                       |
| _[stop_bgmovie]_ | Останавливает воспроизведение видео в фоне.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | [stop_bgmovie]                                                                                                                                                                                                                        |

### Взаимодействие и переменные
