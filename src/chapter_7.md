# Глава 7. Три мини игры

На основе рассмотренной в первой главе повести мы создадим визуальную новеллу на Ren’Py, Twine и TyranoBuilder под 
названием _"Август возвращается"_. В процессе создания предпочтение будет предоставлено больше Ren’Py.

Хотя вы можете написать свою собственную историю, однако, чтобы это сделать правильно, лучше сперва познакомьтесь, как 
происходит процесс превращения повести в игру.

## Составляем план

Перед программированием, желательно составить план для вашего приключения, то есть сделать каталогизацию персонажей, 
определить сцены. Может показаться это лишним, но без этого не обойтись при работе в больших командах.

Сначала разложим повесть _"Август возвращается"_ на блоки в виде таблиц. Так же вы можете воспользоваться другим методом 
визуализации для этих целей. Главное – не пропускать данный этап, во избежание негативных последствий при создании игры.

### Состав персонажей

Начнем с персонажей (см. Таблицу 7-1). Если забыли про них, то вернитесь к первой главе книги.

В это же главе повторите материал про 12 архетипов личности Джозефа Кэмпбелла, некоторые из них будут использованы в 
создаваемой игре.

__Таблица 7-1.__ Главные герои

| Герой                         | Роль/Архетип                | Пол и Возраст         | Внешний вид                                                 |
|-------------------------------|-----------------------------|-----------------------|-------------------------------------------------------------|
| _**Рон Легион-Смерти**_       | Главный герой (т. е. игрок) | Мужчина, около 30 лет | Среднего телосложения и роста, на вид физически подтянутый  |
| _**Мервин Попплуэлл**_        | Искатель                    | Мужчина, лет за 30    | Худой, среднего роста, небрежно одетый                      |
| _**Ройстон Медовая-Бабочка**_ | Мудрец                      | Мужчина, 50 лет       | Крепкое телосложение, имеет обычный вид                     |
| _**Клэр**_                    | Правитель                   | Женщина, около 20 лет | Спортивное телосложение, среднего роста, модно одетая       |
| _**Человек в комбинезоне**_   | Бунтарь                     | Мужчина, без возраста | Спортивное телосложение, высокий, лысый с причудливым видом |
| _**Рейн**_                    | Любовник                    | Женщина, около 30 лет | Среднее телосложение, низкий рост, изящный вид              |

### Локации

В визуальных новеллах главное не количество локаций, а количество слов в повествовании. В среднем это от 10000 до 50000 
слов.

> Примечание:
> 
> Игра, создаваемая в этой книге, не соответствует вышеуказанному правилу.

По сравнению с каталогизацией персонажей, определиться с локациями событий в игре сложнее. Слишком малое количество 
портят атмосферу, а слишком много сбивают с толку игрока. Лучше всего начать с малого, определить основные элементы 
игры, после чего разделить их на более мелкие единицы (например, комнаты) (см. Таблицу 7-2).

Для построения истории мы воспользуемся такими понятиями как:

* **Сеттинг** – это среда, в которой происходит действие, где определяются базовые свойства реальности. В нашем случае 
это общая тема, атмосфера происходящего (например, стиль фона).
* **Место**, обстоятельство и время при которых развиваются события. Здесь могут быть применены разные звуковые дорожки,
задний фон.
* **Комнаты** – наименьшая единица локации игры, которые часто имеют связь между собой.

__Таблица 7-2.__ Основные сеттинги и места повести "Август возвращается"

| Сеттинг                              | Место                                      | Пример описание комнаты                                                                                                                                                                           |
|--------------------------------------|--------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| _**Офис**_                           | _Рабочее место Рона_                       | Вы бездельничаете за рабочим столом, на котором среди стопок бумаг стоит персональный компьютер. Только наклейка с изображением женщины-киборга выделяет ваше рабочее место среди всех остальных. |
| _**Офис**_                           | _Помещение, где храниться сотовый телефон_ | Поднявшись на верхний этаж, вы попадаете в заброшенную часть офиса со старой мебелью.                                                                                                             |
| _**Город**_                          | _Парк, Арка_                               | Ночь, одинокая арка городского парка, статуи освещённые тусклым светом, только усиливают волнения и страх вызванный недавними событиями.                                                          |
| _**Офис (Пожар)**_                   | _Рабочий стол Рона_                        | Ад. Рабочее место Рона окутано огнём. Защищаясь портфелем, он ныряет в него.                                                                                                                      |
| _**Город (Жилой район)**_            | _Квартира Рона_                            | Квартира главного героя становится не такой безопасной, когда из-за двери доносятся странные звуки.                                                                                               |
| _**Город (Железнодорожный вокзал)**_ | _Железнодорожный вокзал_                   | Вы испуганный, лихорадочно просматриваете расписание движения поездов в поиске ближайшего, который готов к отправке.                                                                              |
| _**Поезд**_                          | _Поезд на север_                           | Сидя в мягком сиденье поезда, женщина с черными волосами напротив вас сняла наушники, улыбнулась и представилась.                                                                                 |
| _**Конечная станция**_               | _Конечная станция_                         | Пытаясь слиться с толпой, вас ловят за руку.                                                                                                                                                      |
| _**Остров**_                         | _Остров_                                   | Вы высаживаетесь на острове, для вас это чужой мир. Холод проникает до дрожи костей. Корабль покидает причал, и вы остаетесь один на холодном северном ветре.                                     |
| _**Остров**_                         | _Бункер_                                   | Незаметное снаружи строение на удивление оказалось просторным, комфортным, с отличной мебелью. Это напоминало больше отель нежели бункер.                                                         |
| _**Океан**_                          | _Судно_                                    | По правому борту без опознавательных знаков появляется второе судно. Вы начинаете паниковать.                                                                                                     |
| _**Север**_                          | _Аэропорт_                                 | Вы оказываетесь в международном аэропорту, заполненным огромным количеством людей. Возможность раствориться в толпе успокаивает вас.                                                              |
| _**Город**_                          | _Аэропорт_                                 | Вас окружает беззаботная жизнь. Туристы, тянут свой багаж, но вы внутренне готовитесь к битве всей своей жизни.                                                                                   |
| _**Город**_                          | _Резиденция президента_                    | Нет времени любоваться городом. По вам открыли огонь, остается только бежать.                                                                                                                     |
| _**Новый офис**_                     | _Новое рабочее место Рона_                 | Прежде чем приступить к новым обязанностям, он с тяжестью в душе возвращает старый сотовый телефон в шкаф.                                                                                        |

Теперь разделим вышеупомянутые места на более мелкие эпизоды, а именно на комнаты. Давайте сперва это сделаем для 
сеттинга "Офис" (см. Таблицу 7-3).

__Таблица 7-3.__ Сеттинг "Офис" в повести "Август возвращается"

| Сеттинг    | Место                                          | Комната                       | Связанные комнаты                                    |
|------------|------------------------------------------------|-------------------------------|------------------------------------------------------|
| _**Офис**_ | _Рабочее место Рона_                           | _Рабочий стол Рона_           | _Зона с питьевым фонтанчиком, Рабочий стол Ройстона_ |
|            |                                                | _Зона с питьевым фонтанчиком_ | _Рабочий стол Рона, Соседний рабочий стол_           |
|            |                                                | _Соседний рабочий стол_       | _Зона с питьевым фонтанчиком_                        |
|            | _Верхний этаж (т. е. место хранение телефона)_ | _Рабочий стол Ройстона_       | _Рабочий стол Рона, Шкаф для документов_             |
|            |                                                | _Шкаф для документов_         | _Рабочий стол Ройстона_                              |

#### _Сеттинг I. Офис_

Как вы, помните, наше приключение начинается с того, что Рон получает загадочное письмо от умершего коллеги, некоего 
Мервина Попплуэлла.

Замечания по обстановки в **Офисе**:

* Тон написания должен быть мрачным и зловещим.
* Звуковое сопровождение — это рабочий шум офиса, звуки работающей аппаратуры, ксерокса, приглушенные голоса 
сотрудников, телефонный звонки и разговоры.

#### _Сеттинг II. Город_

Выполняя инструкцию из загадочного письма, мы идем по улицам города в направлении арки парка (см. Таблицу 7-4).

__Таблица 7-4.__ Сеттинг "Город" в повести "Август возвращается"

| Сеттинг     | Место   | Комната             | Связанные комнаты |
|-------------|---------|---------------------|-------------------|
| _**Город**_ | _Парк_  | _Парк_              | _Арка_            |
|             | _Арка_  | _Арка_              | _Парк_            |
|             | _Улица_ | _Дорога мимо офиса_ | _Арка_            |
|             |         | _Увиденный пожар_   | _Нет_             |

Замечание к дизайну **Города**:

* Тон письма по-прежнему должен быть зловещим.
* Звук — это уличная суета: проезжающие мимо автомобили, шаги людей, разговоры по мобильным телефонам, и иногда сигнал 
работающего светофора.

#### _Сеттинг III. Офис (Пожар)_

Это один из опасных моментов в приключениях нашего главного героя. Рон решился вернуться в свой офис, но он оказался 
охвачен огнем (см. Таблицу 7-5). Не имея средств защиты, кроме портфеля, он бросается в жерло пожара.

__Таблица 7-5.__ Сеттинг "Офис (Пожар)" в повести "Август возвращается"

| Сеттинг            | Место                  | Комната             | Связанные комнаты                    |
|--------------------|------------------------|---------------------|--------------------------------------|
| _**Город**_        | _Вход в офис со двора_ | _Переулок_          | _Пожарная лестница_                  |
| _**Офис (Пожар)**_ |                        | _Пожарная лестница_ | _Помещение офиса_                    |
|                    |                        | _Помещение офиса_   | _Рабочий стол Рона_                  |
|                    |                        | _Рабочий стол Рона_ | _Соседний стол А_                    |
|                    |                        | _Соседний стол А_   | _Рабочий стол Рона, Соседний стол Б_ |
|                    |                        | _Соседний стол Б_   | _Соседний стол А_                    |

Замечания по обстановке в сеттинге **Офис (Пожар)**:

* Тон повествования должен выражать огорчение и растерянность главного героя.
* Аудио сопровождение в данном сеттинге — это звуки пожарных машин, пламени и обрушения внутри здания.

#### _Сеттинг IV. Город (Жилой район)_

В этой точке сюжета Рон направляется домой. Но и здесь что-то происходит непонятное. Он слышит, странные звуки из своей 
квартиры. Рон чувствует интуицией, что если туда войдет, то уже никогда из неё не выйдет (см. Таблицу 7-6).

__Таблица 7-6.__ Сеттинг "Город (Жилой район)" в повести "Август возвращается"

| Сеттинг                   | Место           | Комната               | Связанные комнаты        |
|---------------------------|-----------------|-----------------------|--------------------------|
| _**Город (Жилой район)**_ | _Квартира Рона_ | _Улица_               | _Нет_                    |
|                           |                 | _Коридор_             | _Улица_                  |
|                           |                 | _Дверь квартира Рона_ | _Коридор, Квартира Рона_ |
|                           |                 | _Квартира Рона_       | _Нет_                    |

Замечание к дизайну **Город (Жилой район)**:

* Написание в этой короткой, но напряженной сцене, должно передавать чувство обреченности.
* Что касается аудио, то мы должны услышать эхо шагов и непривычные инопланетные звуки.

#### _Сеттинг V. Город (Железнодорожный вокзал)_

Теперь, находиться в городе стало опасно для жизни Рона, его нужно немедленно покинуть, из-за чего он как можно скорей 
пытается добраться до вокзала. Где Рон садится на первый поезд, идущий на север (см. Таблицу 7-7).

__Таблица 7-7.__ Сеттинг "Город (Железнодорожный вокзал)" в повести "Август возвращается"

| Сеттинг                              | Место                    | Комната       | Связанные комнаты     |
|--------------------------------------|--------------------------|---------------|-----------------------|
| _**Город (Железнодорожный вокзал)**_ | _Железнодорожный вокзал_ | _Статуя_      | _Платформа А_         |
|                                      |                          | _Платформа А_ | _Статуя, Платформа Б_ |
|                                      |                          | _Платформа Б_ | _Поезд_               |
|                                      |                          | _Поезд_       | _Нет_                 |

Замечание к дизайну **Город (Железнодорожный вокзал)**:

* Тон написания остаётся прежним. Рона преследуют, и он в панике.
* Звук в этом сеттинге такой же, как и в городе, только сообщает о присутствии большого количества людей.

#### _Сеттинг VI. Поезд_

Зайдя в поезд, Рон немного успокаивается. Однако это спокойствие длится недолго, его продолжают преследовать 
(см. Таблицу 7-8). В результате он запирается в туалете, прячась от преследователей. В этот момент ему позвонили на 
старый мобильный телефон, и сказали покинуть поезд на ближайшей станции.

__Таблица 7-8.__ Сеттинг "Поезд" в повести "Август возвращается"

| Сеттинг     | Место            | Комната           | Связанные комнаты            |
|-------------|------------------|-------------------|------------------------------|
| _**Поезд**_ | _Поезд на север_ | _Двери поезда_    | _Нет_                        |
|             |                  | _Первый вагон_    | _Второй вагон, Двери поезда_ |
|             |                  | _Второй вагон_    | _Первый вагон_               |
|             |                  | _Туалет в поезде_ | _Второй вагон, Третий вагон_ |
|             |                  | _Третий вагон_    | _Нет_                        |

Замечание к дизайну сеттинга **Поезд**:

* Обстановка в плане драматичности остаётся прежней и усиливается к завершению данного сеттинга.
* Атмосфера – тихий шум движущегося поезда.

#### _Сеттинг VII. Конечная станция_

Рон, не зная, что делать, метается по платформе, пока его не хватает кто-то за руку. Рона начинает трясти, но это 
оказался коллега из отдела технической поддержки Ройстон Медовая-Бабочка. После встречи они оказываются в парке на 
скамейке возле станции, где Рону сообщают о деталях происходящего (см. Таблицу 7-9).

__Таблица 7-9.__ Сеттинг "Конечная станция" в повести "Август возвращается"

| Сеттинг                | Место              | Комната            | Связанные комнаты            |
|------------------------|--------------------|--------------------|------------------------------|
| _**Конечная станция**_ | _Конечная станция_ | _Платформа А_      | _Платформа Б_                |
|                        |                    | _Платформа Б_      | _Платформа А, Дорога в парк_ |
|                        |                    | _Дорога в парк_    | _Скамейке в парке_           |
|                        |                    | _Скамейке в парке_ |                              |

Замечание к дизайну сеттинга **Конечная станция**:

* Не считая ситуации на платформе, сеттинг имеет расслабленный тон повествования. В этой сцене благодаря встречи с 
союзником главный герой чувствует себя в безопасности.
* Звуковое сопровождение должно быть как в сеттинге «Город», но более тихим и не таким насыщенным.

#### _Сеттинг VIII. Остров_

Когда Ройстон покинул Рона, ему снова позвонили на телефон. Рейн сообщает ему, что нужно избавиться от телефона, и 
используя поезд, паром, рыбацкую лодку, прибыть в течении трёх дней на самый дальний остров на севере (см. Таблицу 7-10).

На самом острове Рона встречает погибший Мервин Попплуэлл, и скрывшись в бункере из четырех комнат, за чашкой чая Рону 
рассказывают, что нужно закончить работу над системой безопасности «Август».

Поскольку команда не может защититься, на помощь, используя вертолет, прилетает Ройстон Медовая-Бабочка.

__Таблица 7-10.__ Сеттинг "Остров" в повести "Август возвращается"

| Сеттинг      | Место    | Комната                       | Связанные комнаты                                                                 |
|--------------|----------|-------------------------------|-----------------------------------------------------------------------------------|
| _**Остров**_ | _Остров_ | _Берег_                       | _Путь к бункеру А_                                                                |
|              |          | _Путь к бункеру А_            | _Путь к бункеру Б_                                                                |
|              |          | _Путь к бункеру Б_            | _Вход в бункер_                                                                   |
|              |          | _Вход в бункер_               | _Первая комната в бункере_                                                        |
|              | _Бункер_ | _Первая комната в бункере_    | _Вторая комната в бункере, Третья комната в бункере, Четвертая комната в бункере_ |
|              |          | _Вторая комната в бункере_    | _Первая комната в бункере, Третья комната в бункере, Четвертая комната в бункере_ |
|              |          | _Третья комната в бункере_    | _Первая комната в бункере, Вторая комната в бункере, Четвертая комната в бункере_ |
|              |          | _Четвертая комната в бункере_ | _Первая комната в бункере, Вторая комната в бункере, Третья комната в бункере_    |

Замечание к дизайну сеттинга **Остров**:

* Остров — это место, где главный герой приходит в себя и собирается с силами, все это должен отобразиться в сценарий. 
После напряженного начала на этом этапе игры игрок чувствует себя непринужденно.
* Так как события происходят на дальнем севере мы должны слышать звуки океана и сильного ветра.

#### _Сеттинг IX. Океан_

Спустя несколько дней к Рону прибывает Рейн и предлагает покинуть бункер, так как в резиденции президента произошло 
чрезвычайное происшествие. Рон принимает предложение. После чего они покидают остров, погрузившись на судно на воздушной 
подушке. Хоть это и короткая сцена, но из-за эпизода с нападением на корабль, очень напряженная (см. Таблицу 7-11).

__Таблица 7-11.__ Сеттинг "Остров" в повести "Август возвращается"

| Сеттинг     | Место                   | Комната  | Связанные комнаты |
|-------------|-------------------------|----------|-------------------|
| _**Океан**_ | _Судно_                 | _Палуба_ | _Рубка_           |
|             |                         | _Рубка_  | _Палуба_          |
|             | _Спасательный вертолёт_ | _Рубка_  | _Палуба_          |
|             |                         | _Палуба_ | _Рубка_           |

Замечание к дизайну сеттинга **Океан**:

* Тон написание должен вызывать чувство динамики и опасности. 
* Звук соответствует тону письма. Мы слышим двигатель судна, тяжелые шаги, металлическое эхо, грохот дверей, шум волн 
океана, и в итоге нарастающий звук вертолета.

#### _Сеттинг X. Север_

Рон и его друзья покинули остров и высадились на побережье материка, где их уже ждала машина, чтобы отвезти в аэропорт. 
Используя частный самолёт, они вылетают в столицу. Во время полёта они узнают про ужасные события в резиденции 
президента (см. Таблицу 7-12).

__Таблица 7-12.__ Сеттинг "Север" в повести "Август возвращается"

| Сеттинг     | Место       | Комната                 | Связанные комнаты                         |
|-------------|-------------|-------------------------|-------------------------------------------|
| _**Север**_ | _Побережье_ | _Побережье_             | _Автомобиль в аэропорт_                   |
|             | _Аэропорт_  | _Автомобиль в аэропорт_ | _Зона аэропорта А_                        |
|             |             | _Зона аэропорта А_      | _Зона аэропорта Б, Автомобиль в аэропорт_ |
|             |             | _Зона аэропорта Б_      | _Самолет в столицу_                       |
|             |             | _Самолет в столицу_     | _Нет_                                     |

Замечания к дизайну сеттинга **Север**:

* Текст в этом сеттинге должен спокойно вести повествование, так как большую часть врагов погибло в предыдущем сеттинге. 
Однако, происшествие в резиденции может поставить крест на миссии. 
* Звуковой фон должен успокаивать игрока. Можно добавить звуки поездки с берега в аэропорт, звук двигателя самолёта.

#### _Сеттинг XI. Город_

Рон и его друзья, прибыв в столицу, немедленно направляются в резиденцию президента (см. Таблицу 7-13). Где Рон 
встречает Клер и человека в комбинезоне. Им сообщают, что премьер-министр похищен, и чтобы его освободить Рон должен 
передать исходный код системы безопасности «Августа».

Рон соглашается с выдвинутыми условиями, но ухитряется обмануть врагов, подсунув им исправную систему безопасности, а 
спецназ в свою очередь обезвреживает всех сотрудников «Фракции».

В конце концов Рон оказывается дома, а когда возвращается офис, узнает, что он получает должность, которую раньше 
занимал Ройстон. Конец!

__Таблица 7-13.__ Сеттинг "Город" в повести "Август возвращается"

| Сеттинг     | Место                   | Комната                          | Связанные комнаты                |
|-------------|-------------------------|----------------------------------|----------------------------------|
| _**Город**_ | _Аэропорт_              | _Прибытие_                       | _Машине в резиденцию президента_ |
|             |                         | _Машине в резиденцию президента_ | _Лестница_                       |
|             | _Резиденция президента_ | _Лестница_                       | _Парадный вход_                  |
|             |                         | _Парадный вход_                  | _Зал, Лестница_                  |
|             |                         | _Зал_                            | _Парадный вход_                  |
|             | _Дом Рона_              | _Приемная_                       | _Спальня_                        |
|             |                         | _Спальня_                        | _Приемная, Балкон_               |
|             |                         | _Балкон_                         | _Спальня_                        |


Замечание к дизайну сеттинга **Город**:

* Тон письма должен быть сухим, холодным. Он должен показать в действиях главного героя твёрдость и расчетливость. Рон за 
нескольких недель своих приключений пережил многое, стал мудрее.
* Что касается звука, находясь в столице — это шум города, а попав в резиденцию президента – это тихая атмосфера. Так же 
мы должны выделить динамические сцены и сцены, в которых нужно принимать судьбоносные решения.

#### _Сеттинг XII. Новый офис_

Рон возвращается на работу. Офис отремонтирован за время его отсутствия, стоят новые рабочие столы и компьютеры 
(см. Таблицу 7-14).

Появляется Ройстон и говорит, что уходит на пенсию. Он предлагает Рону занять его место в отделе технической поддержки. 
Рон не задумываясь соглашается, понимая, что в будущем его ожидают новые приключения.

__Таблица 7-14.__ Сеттинг "Новый офис" в повести "Август возвращается"

| Сеттинг          | Место                                      | Комната                                            | Связанные комнаты                                    |
|------------------|--------------------------------------------|----------------------------------------------------|------------------------------------------------------|
| _**Новый офис**_ | _Новое рабочее место Рона_                 | _Рабочий стол Рона_                                | _Зона с питьевым фонтанчиком, Рабочий стол Ройстона_ |
|                  |                                            | _Соседний рабочий стол_                            | _Новое рабочее место Рона_                           |
|                  | _Помещение, где храниться сотовый телефон_ | _Рабочий стол Ройстона (Новое рабочее место Рона)_ | _Новое рабочее место Рона, Хранилище документов_     |
|                  |                                            | _Хранилище документов_                             | _Рабочий стол Ройстона_                              |

Замечание к дизайну сеттинга **Новый офис**:

* Текст должен вызывать чувство триумфа и оптимизма.
* В этом сеттинге мы должны слышать спокойную рабочую обстановку в офисе.

## Часть I: Начало "Август возвращается" в Ren’Py

Теперь пришло время приступить к написанию кода. "Август возвращается" имеет 61 комнату, приблизительно от 2000 до 2500 
слов, и этого достаточно чтобы познакомится с процессом разработки игр в Ren’Py.

### Создание проекта

На Лаунчере Ren’Py нажмите _"Добавить новый проект"_. У вас запросят указать имя проекта на латинице, в нашем случае — 
это _"Avgust Vozvrashaetsya"_. Затем выбираем разрешение для проекта, по умолчанию это 1920x1080 (Full HD) и нажимаем 
_"Продолжить"_. На следующем шаге задаём _цветовую схему_ игры. Если возникнет потребность данные параметры можно будет 
изменить. После нажатия _"Продолжить"_, Ren’Py выполнить процесс создания проекта и вернёт вас на главный экран лаунчера. 

В левой части в разделе _"Проекты"_, выберите "Avgust Vozvrashaetsya". Далее в разделе _"Редактировать файл"_ нажмите 
на файле _script.rpy_. Он откроется в текстовом редакторе. Это основной скрипт игры. На протяжении данной главы мы в 
основном будем работать только с ним.

Нужно отметить, что скрипты Ren’Py очень чувствительны к пробелам и синтаксису. Например, некоторые текстовые редакторы 
выполняют авто форматирование и заменяют _обычные кавычки_ на _изогнутые_. Это приводит к тому, что Ren’Py не может 
выполнить скрипт. Желательно отключите авто форматирование в вашем текстовом редакторе или используйте IDE 
(интегрированную среду разработки).

### Настройка персонажей

По умолчанию в файле сценария присутствует персонаж Эйлин. Мы его заменим на свой список персонажей указав имя и цвет 
диалога.

Для цвета в Ren’Py используется шестнадцатеричный формат, как и в HTML. В котором первые две цифры это красный цвет, 
следующие две – зелёный, а последние две – синий. Диапазон значений состоит от 0 до 9, потом от A до F. Например, 
красный цвет имеет значение: _#FF0000_, а черный: _#000000_.

Откройте файл script.rpy и найдите следующую строку:

```python
define e = Character('Эйлин', color="#c8ffc8")
```

И вместо неё вставьте следующий код:

```python
define reg = Character("Рон Легион-Смерти", color="#0099BB")
define merv = Character("Мервин Попплуэлл", color="#007799")
define roy = Character("Ройстон Медовая-Бабочка", color="#0044CC")
define rai = Character("Рейн", color="#8888EE")
define cla = Character("Клэр", color="#AA1100")
define man = Character("Человек в комбинезоне", color="#EE1100")
```

Как видим для каждого персонажа задаётся имя и цвет диалога, а сам персонаж в свою очередь присваивается константе виде 
сокращенного имени. Для различия главному герою и его команде задаются цвета синих оттенков, а стороне антагониста 
оттенки красного цвета.

### Переходы

Ранее в этой книге мы уже познакомились со стандартными переходами в Ren’Py (например, _затухание_, _растворение_, 
_пикселизация_), но иногда нужно создать переходы с индивидуальными параметрами. Добавим два таких перехода в скрипт 
игры. Первый это _"slideleft"_ - слайдер в лево, который выполняет переход в течении двух секунд. Второй _"fireflash"_ -
вспышка, который представляет собой переход к ярко-оранжевому цвету и обратно. Он будет использоваться для сцен пожара. 

```python
define slideleft = CropMove(2.0, "slideleft")
define fireflash = Fade(0.1, 0.0, 0.5, color="#e40")
```

### Изображения для персонажей

На лаунчере Ren’Py в раздел _"Открыть папку"_ есть ссылка _images_. После её нажатия откроется каталог с изображениями 
проекта.

Чтобы назначить изображение персонажу, нужно выполнить следующие правило: имя файла с изображением должно совпадать с 
именем константы, в которой храниться персонаж. Например, в нашем случае нужно добавить изображения с именами _reg.png_, 
_merv.png_, _roy.png_ и так далее. Так же файл с именем _Reg.png_ соответствует _reg.png_ и будет присвоен персонажу, 
но файл с именем _Reginald.png_ уже не подойдёт.

Нужно не забывать, что Ren’Py для персонажей использует формат изображения PNG и WEBP, а для фона JPG, PNG и WEBP.

### Подготовка ассетов

Хоть Ren’Py на основе имени автоматически подгружает изображения персонажей, то остальные аудиовизуальные ресурсы нужно 
явно определить в файле скрипта. Как мы увидим позже большая часть ресурсов в создаваемой игре это фоновые изображения 
в формате jpg, которым присвоены соответствующие имена.

Единственным исключением является персонаж Рейн. В определённый момент игры её лицо становится серьёзным. Для этого мы 
дополнительно загружаем изображение выполнив следующую команду:

```python
image rai serious = "rai_serious.png"
```

Теперь для вывода персонажа Рейн с серьезным выражением лица нужно выполнить команду _rai serious "Да, я серьезно!"_. 
На основе данного приёма сделайте своих персонажей более живыми используя как можно больше изображений с различными 
эмоциями лица.

Помните, вы можете использовать оператор image для определения как основного портрета персонажа (например, 
_image jimmy = "jimmy.png"), так и для дополнительных (например, _image jimmy happy = "jimmyhappy.png"_). Однако перед 
этим вам нужно определить персонажа (например, _define jimmy = Character("Jimmy")_), что мы и сделали в главе 
_"Настройка персонажей"_.

Теперь давайте определим ассеты для офиса, которые можно скрывать и показывать при помощи команд _hide_ и _show_ 
(например, чтобы показать изображение офиса _office1_.jpg, нужно выполнить команду: _show office_, а чтобы скрыть 
выполнить команду: _hide office_)

```python
image office = "office1.jpg"
image office2 = "office2.jpg"
image email = "email.jpg"
image topfloor = "topfloor.jpg"
image cooler = "cooler.jpg"
```

Далее назначим изображения для сцен города, парка, станции и т.д.:

```python
image london = "london.jpg"
image london2 = "london2.jpg"
image park = "park1.jpg"
image park2 = "park2.jpg"

image alley = "alley.jpg"
image door = "door.jpg"
image window = "window.jpg"

image station = "station.jpg"
```

В конце, определим четыре изображения для огня, которые будут отображаться в случайном порядке, чтобы показать хаос 
пожара.

```python
image fire1 = "fire1.jpg"
image fire2 = "fire2.jpg"
image fire3 = "fire3.jpg"
image fire4 = "fire4.jpg"
```

### В бой!

Теперь мы приступим к написанию основного сценария. Укажем кто мы и чем занимаемся. Для этого отобразим портрет главного 
героя в точке с координатами xpos: 0.7 и ypos: 0.2, где значение 0.0 – это левый край, а 1.0 правый. Так же применим 
ранее определённый эффект скольжения.

Но сначала зададим следующие переменные, которыми воспользуемся позже.

```python
# Начало игры

label start:

# Определяем переменные

    $ sips = 0
    $ time = 0
    $ items = []
    $ dvd_found = False
```

При написании скрипта, не забывайте корректно задавать отступы для блоков кода.

Далее вставляем пустую строку и прописываем щелчки мыши:

```python
    play sound [ "<silence 1.5>", "sounds/mouse_clicks.wav" ]
```

Данная строка найдет в каталоге со звуками файл "sounds/mouse_clicks.wav" и воспроизведёт его с паузой в 1,5 секунды.

```python
    show office1
    with slideleft
```

Теперь отобразим фон офиса с именем _office1_ используя ранее определённый переход _slideleft_. Эти две строки должны 
иметь одинаковый отступ иначе при запуске игры возникнет ошибка. Чтобы с отступами было меньше проблем, то лучше 
использовать более продвинутые текстовый редактор, которые позволяет делать отступы при помощи кнопки Tab.

```python
    show reg:
        xalign 0.0
        xpos 0.7
        ypos 0.2
    with easeinleft

    "Рон Легион-Смерти, правительственный эксперт по кибербезопасности, бездельничал за своим рабочим столом."

    "Вместо работы над проектом, он смотрел смешные видеоролики в интернете."

    "Рон находился в депрессии из-за смерти своего лучшего и единственного друга по офису Мервина Попплуэлла."
```

В результате после запуска игры будет отображено стартовое меню. После нажатия _"Начать"_ начнётся повествование 
истории, появится изображение офиса и портрет главного героя. Если после нажатия _"Запустить проект"_ и в игре не 
появились внесённые изменения, то вероятно не был сохранен файл сценария игры.

### Комментирование кода

Хорошим тоном написания сценария – это его комментирование, особенно когда вы работаете в большой команде. В Ren’Py – 
это делается с помощью символа хэштега (#).

Например, добавьте данный комментарий перед появлением портрета главного героя с текстом "Рон Легион-Смерти, 
правительственный…".

```python
# Комната 1: Рабочий стол Рона
```

Хоть Ren’Py имеет строгие правила к отступам, но они не распространяется на комментарии, которые не являются частью 
кода.

### Ваше первое меню

Теперь мы при помощи меню реализуем взаимодействие пользователя с игрой.

Однако сперва для работы меню нужно определить переменные после метки "start". Чтобы это сделать используйте следующий 
синтаксис: _$ variable_name = 0_, где _variable_name_ – имя переменной.

```python
label start:
    $ sips = 0
    $ time = 0
    $ items = []
```

Как видим, инициализируется три переменных: _sips_ – которая используется для подсчета количества сделанных глотков воды 
главным героем, переменная _time_ будет подсчитывать количество проведённого времени, а переменная _items_, которая 
является пустым массивом, будет хранить в себе инвентарь. Однако Ren’Py не имеет массивов как таковых, вместо этого он 
использует _списки_.

Добавим следующий код в конец основного скрипта:


```python
    menu deskaction:
     "Выбери действие"
     "Посетить зону с питьевым фонтанчиком":
         $ time += 1
         stop sound fadeout 1.0
         hide office1
         show cooler
         with dissolve
         jump drinkingfountain
         
     "Осмотреть рабочий стол коллеги":
         $ time += 1
         stop sound fadeout 1.0
         hide office1
         show office2
         with dissolve
         jump neighboringdesk

    menu drinkingfountain:
             "Выбери действие"
             "Вернуться к своему рабочему столу":
                 jump deskaction
                 
             "Выпить":
                 $ sips += 1
                 
                 "Сделано глотков [sips]."
                 jump deskaction

    label neighboringdesk:
           if time>3:
               jump emailreceived

           if time<=2:
               "Коллег ушел рано. Его рабочий стол пуст."
               hide office2
               show office1
               with dissolve
               show reg
               jump deskaction
           else:
               "Соседний рабочий стол убран."
               hide office2
               show office1
               with dissolve
               show reg
               jump deskaction
```

В данном коде для создания меню используются такие ключевые слова как _menu_, _jump_ и _label_. Каждое меню должно иметь 
метку, в нашем случае это _deskaction_. А сочетание слов jump (прыжок) и label (метка) позволит выполнит переход по 
самому меню, и переход в нужную точку сценария. Так же обратите внимание, как используется знак двоеточия в конце меток 
и пунктов меню.

При выборе пункта меню «Выпить», над переменной выполняется операция +=, а потом она выводится в строке через квадратные 
скобки. Таким образом мы подсчитываем сколько Рон сделал глотков воды пока находился возле фонтанчика с водой. Каждое 
такое действие увеличивает количество глотков на единицу, но если нужно сделать 60 глотков, то строка имела бы вид 
_$ sips += 60_.

### Использование условного оператора

Благодаря условному оператору _if_, _elif_ и _else_ игру можно сделать более разнообразной и интересной. Для этого 
замените код от строки _menu drinkingfountain:_ до _jump deskaction_ на следующий: 

```python
    menu drinkingfountain:
             "Выбери действие"

             "Вернуться к своему рабочему столу":
                 jump deskaction

             "Выпить":
                 $ sips += 1
                 play sound "sounds/gulp.wav"

                 if sips<3:
                     "Сделано глотков [sips]."
                     show office1
                     with dissolve
                     jump deskaction
                 elif sips==3:
                     "После [sips] глотков, вы утолили жажду."
                     show office1
                     with dissolve
                     jump deskaction
                 else:
                     "Пропало желание пить."
                     show office1
                     with dissolve
                     jump deskaction
```

Как видим благодаря условному оператору мы проверяем переменную _sips_ и в зависимости от количества глотков сообщаем, 
что Рон утолил жажду. Условный оператор состоит из самого условия, которое прописывается после слова _if_, ключевого 
слова _elif_ (если ещё), который используется для проверки дополнительных условий, и слова _else_, код после которого 
будет выполняться если ни одно из условий не выполнено.

Теперь давайте добавим еще условие, на основе переменной _time_. Для этого внесём изменения в код меню _deskaction_:

```python
     "Посетить зону с питьевым фонтанчиком":
         $ time += 1
         jump drinkingfountain
         
     "Осмотреть рабочий стол коллеги":
         $ time += 1
         jump neighboringdesk
```

Далее добавим условный оператор после строки _label neighboringdesk_:

```python
           if time>3:
               jump emailreceived
```

Этот код просто проверяет количество выполненных действий в игре, и когда число больше трёх, мы переходим к метке 
_emailreceived_.

Теперь сменим декорации. Добавьте следующие строки кода после _jump deskaction_:

```python
    # Время электронной почты
    label emailreceived:
        scene email
        with dissolve
```

При помощи команды scene очищаем сцену от всех отображаемых объектов (т. е. фон и спрайты персонажей), и взамен 
показываем новый фон. После чего уведомляем игрока звуком колокольчика о получении электронного письма.

```python
        play sound "sounds/email.wav"

        "Рон вернулся к своему рабочему столу, и замечает, что ему пришло письмо."
        "Оно содержало следующее сообщение: \"Встретимся сегодня в семь вечера в Парке возле Aрки. Никому не говори об этой встречи …\""
        "... и подписано Мервин Попплуэлл."
        "Это какая-то шутка. Мервина же больше нет."
        "Рон решает позвонить Ройстону сотруднику из технической поддержки, чтобы узнать, кто прислал это письмо."
        "После телефонного звонка, выясняется, что письмо настоящее, и Ройстон просит Рона подняться на верхний этаж."
```

Согласно повествованию, следующее место действия – это верхний этаж.
В этой сцене так же используется условный оператор. Будет выполнена проверка переменной sips, чтобы узнать, немного ли 
выпил игрок воды, и если да, то отобразить шутливое сообщения.

```python
label topfloor:

    scene topfloor
    with dissolve

    # Показываем изображение телефона
    show phone:
        xalign 0.0
        xpos 0.5
        ypos 0.18
    with easeinleft
```

Кроме изображений фона и персонажей Ren’Py может отобразить любой другой спрайт. Если посмотреть пример предыдущего 
кода, то сценарий выводит спрайт мобильного телефона используя эффект _easeinleft_. Далее отображается диалог, а затем 
телефон исчезает с эффектом _easeoutright_.

```python
    "Там Рон находите мобильный телефон 80-х годов, и забирает его с собой."

    hide phone
    with easeoutright
```

Теперь реализуем инвентарь. Используя метод _append_, добавим первый элемент инвентаря - мобильный телефон, и подадим 
специальный сигнал игроку.

```python
    play sound "sounds/sound.wav"
    $ items.append("специальный телефон")

    scene london
    with dissolve

   # Если игрок выпил слишком много воды, показываем сообщение
    if sips >= 3: 
        "Нужно сходить в туалет."
    "Он всё же решается на встречу, предложенную в электронном письме."

   # Парк
    label hydepark:
    play music [ "sounds/park.mp3" ] fadein 10.0 loop
```

Возможно, вы помните Ren’Py по умолчанию имеет три звуковых канала: _sound_, _music_, и _voice_. Как видим, предыдущие 
строки кода демонстрируют нам использование музыкального канала. Мы циклично (_loop_) воспроизводим с нарастанием 
(_fadein_) в 10.0 секунд фоновые звуки парка. 

```python
    scene park
    with dissolve

    "Парк находился всего в нескольких минутах ходьбы от офиса. Идя по дороге к арке парка"
    $ items.append("монета")  

    # Сортируем список элементов
    $ items.sort()

    play sound "sounds/sound.wav"
    "Рон замечаете монету в земле. Он поднял ее и положил в карман."
```

Для сохранения инвентаря мы использовали пустую переменную _items_ и походу игры используя метод _.append_ добавили виде 
строки два предмета _монету_ и _специальный телефон_. Как использовать данный список мы узнаем позже, но самый простой 
пример — это проверять наличие ключа у игрока для открытия двери.

Чтобы упорядочить инвентарь в списке отсортируем его в алфавитном порядке при помощи метода _sort_.

### Настройка скорости текста

