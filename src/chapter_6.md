# Глава 6. Запускаем на популярных платформах

Рассматриваемое программное обеспечение в этой книге не только многофункциональное и удобное, но и имеет возможность 
запускаться на разных платформах. Как это сделать мы подробно рассмотрим в этой главе.

## Ren’Py и персональные компьютеры

Ren’Py "из коробки" развертывается на Windows, macOS и Linux без каких-либо настроек. Для этого на лаунчере Ren’Py в 
разделе _"Действия с проектом"_ выберите _"Построить дистрибутивы"_. Далее указываете для каких платформ вы хотите 
собрать игру и нажимаете _"Построить"_. В таблице 6-1 указан список вариантов сборки и для чего они предназначены.

__Таблица 6-1.__ Варианты сборки игры для персональных операционных систем в Ren’Py

| Вариант                           | Описание                                                                                                                                               |
|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| _PC: Windows and Linux_           | Создаст zip-файл для 32-разрядных и 64-разрядных версий Windows и Linux.                                                                               |
| _Linux_                           | Создаст TAR.BZ2 файл для 32- и 64-разрядной версии Linux                                                                                               |
| _Macintosh_                       | Создаст zip-файл для macOS на базе процессора Intel и Apple Silicon                                                                                    |
| _Windows_                         | Создает zip-файл для 32- и 64-битной версии операционный системы Windows                                                                               |
| _Windows, Mac, Linux for Markets_ | Создаст файлы для Windows, macOS и Linux, необходимые для онлайн-распространения через Itch.io и Steam. Эти файлы не предназначены для прямого запуска |

### Минимальные системные требования

Игры созданные на основе Ren’Py в основном не требовательны к ресурсам компьютерной системы, но всё же имеют 
определённые минимальный требования (см. Таблицу 6-2). Однако, параметры могут измениться, например, если в игре 
использовать видео высокого разрешения, для которого потребуется значительно больше ресурсов компьютера.

На данный момент любой средний компьютер способен запустить любую игру созданную на Ren’Py, а это 4 гигабайта (ГБ) 
системной памяти (т. е. ОЗУ) и хороший двухъядерный процессор, но могут быть и исключения.

Так как для визуализации Ren’Py использует _OpenGL_ и _DirectX_, соответственно видеокарта должна поддерживать, как 
минимум OpenGL 3.0 или DirectX 11. Следовательно, нужно учитывать и версию операционной системы — это _Windows 7_ и выше.

__Таблица 6-2.__ Минимальные требования для игр на Ren’Py

| Платформа | Версия ОС           | Процессор                            | ОЗУ    | Графика                   |
|-----------|---------------------|--------------------------------------|--------|---------------------------|
| _Windows_ | 7 и выше            | 2,0 ГГц, 64-битный Intel-совместимый | 2.0 ГБ | OpenGL 3.0 или DirectX 11 |
| _macOS_   | 10.10 и выше        | 2,0 ГГц, 64-битный Intel-совместимый | 2.0 ГБ | OpenGL 3.0                |
| _Linux_   | Ubuntu 16.04 и выше | 2,0 ГГц, 64-битный Intel-совместимый | 2.0 ГБ | OpenGL 3.0                |

Что касается требования к объёму жёсткого диска, то он зависит от размера вашей игры. Если использовать изображения, 
аудио и видео очень высокого качества, соответственно и игра будет расти в размерах. Однако, необходимо найти 
компромисс между размером и качеством медиа файлов, чтобы игра получилась качественной и занимала как можно меньший 
размер на жестком диске.

### Иконки для персонального компьютера

Чтобы задать значок для игры, поместите файл с расширением icon.ico для Windows и icon.icns для macOS в корневую папку 
игры. Если ваша иконка сохранена в PNG формате, то её нужно преобразовать в формат иконки, простое переименования файла 
здесь не подойдет. В Интернете имеется множество бесплатных онлайн-сервисов для такой операции.

## Ren’Py для мобильных устройств

Помимо поддержки персональных компьютеров, Ren’Py может собрать игру для мобильных устройств на базе iOS и Android. 
Однако данный процесс более сложнее и будет подробно рассмотрен в дальнейших главах.

### Развертываем на Android-е

Ren’Py поддерживает сборку игр для Android. Однако могут появиться не предсказуемые баги, и как следствие игры для этой 
операционной системы нужно тестировать более тщательно.

Первым шагом для отладки игры на Android является загрузка и установка _Ren’Py Android Packaging Tool (RAPT)_. Для этого 
на лаунчере нажмите _Android_ в разделе «Действия с проектом», после чего вам будет предложено загрузить вышеупомянутый 
инструмент, если он ещё не был установлен.

Так же вам понадобится _Java Development Kit_. Ссылку для скачивания можно найти в официальной документации. На данный 
момент URL-адрес такой: [https://adoptopenjdk.net/releases.html?variant=openjdk8&jvmVariant=hotspot](https://adoptopenjdk.net/releases.html?variant=openjdk8&jvmVariant=hotspot).

Теперь нужно настроить компьютер и Android для запуска и отладки игры на устройстве:

1. На Android устройстве откройте _"Настройки\Параметры разработчика"_ и включите _**отладку по USB**_.
2. **Настройте соединение Android Debug Bridge (ADB)** между устройством и персональным компьютером. Для этого 
подключите устройство к компьютеру, чтобы установить драйвер. MacOS это сделает автоматически. В Linux нужно загрузить 
пакет выполнив команду _apt-get install adb_. Что касается Windows, следуя инструкции: 
[https://developer.android.com/studio/run/oem-usb](https://developer.android.com/studio/run/oem-usb), загрузите и 
установите USB-драйвер.
3. Далее **устанавливаем SDK** зайдя в _"Действие с проектом\Android\Установить SDK"_. После установки SDK вам предложат 
создать _цифровой ключ_, который в дальнейшем будет использоваться для подписи пакетов, продаваемых на 
интернет-площадках, например, _Google Play_.
4. **Укажите информацию о вашей игре** выбрав _"Действие с проектом\Android\Настроить"_.
5. Когда игра создана и настроена **подключите Android устройство к компьютеру** и выберите 
_"Действие с проектом\Android\Собрать и установить"_.

### Иконки и экран-заставка

Чтобы задать иконки для приложения, и заставку загрузки разместите соответствующие изображения в корневом каталоге игры.

Иконка состоит из двух изображений переднего плана _android-icon_foreground.png_ с прозрачным фоном и из фонового 
изображения _android-icon_background.png_. Размер этих иконок должен быть 432 x 432 пикселя. При сборке приложения 
Ren'Py преобразует эти файлы в подходящий размер для каждого устройства.

При первом запуске игры на Android или когда игра загружает дополнительные ресурсы с Google Play используются экраны 
заставки. Так как эти процессы занимают некоторое время, то хорошим тоном будет задать данные изображения, поместив их 
в корневую папку игры. Изображение под именем _android-presplash.jpg_, будет использоваться при загрузке приложения, а 
изображение _android-downloading.jpg_ при загрузке ресурсов.

### Сочетания клавиш в Android

При запуске игры Ren'Py на Android кнопки имеют следующие назначение:

* **Домой**: возвращает вас на главный экран Android, приостанавливает игру и автоматически сохраняет её состояние.
* **Увеличение/уменьшение громкости**: используется для регулировки громкости.

### Тестирование Android-приложения

Для тестирования на портативных устройствах Ren'Py поддерживает три режима эмуляции Android: телефон, планшет и 
телевизор. Для её запуска выберите "Действие с проектом\Android\Эмуляция", а далее запускаете требуемый тип эмуляции. 
Для управления игровым процессом используются следующие клавиши: _клик мыши_, который эмулирует касание, _Esc_ для 
вызова меню и _Page Up_ для возврата назад, то есть соответствует кнопке "Назад".

Рассмотрим режимы эмуляции:

* **Телефон**: сенсорное управление имитируется с помощью мыши.
* **Планшет**: управление такое же, как и при эмуляции телефона на Android.
* **Телевизор**: этот режим эмулирует телевизор на базе операционной системы Android. Клавиатура привязана к пульту 
* дистанционного управления, где клавиши со стрелками выполняют навигацию, кнопка _Enter_ это выбор, а _Esc_ вызывает 
* меню. Кроме того, в этом режиме отображаются границы «Небезопасной зоны», в пределах которой контент может 
* отображаться не на всех телевизорах.

### Развертываем на iOS

Развертывать Ren’Py проекты для платформ на iOS можно только на персональном компьютере под управлением macOS. Так как 
поддержка данной платформы находится на стадии разработки, выпушенные игры на основе Ren'Py не соответствуют 
установленным _Apple App Store_ стандартам. Однако, многие игры проходят эту проверку и попадают в Apple App Store. Как 
совет, ваш игра не должна содержать технических проблем, и содержать как можно меньше насилия и обнаженных сцен.

Для тестирования Ren'Py поддерживает два режима эмуляции это iPhone и iPad. Оба режима имитируют работу с сенсорным 
экраном, поэтому управление происходит при помощи мыши. 

Чтобы добавить отладку в Ren’Py на iOS, сперва, нужно загрузить программное обеспечение _renios_. Для этого перейдите 
на лауйнчере Ren’Py "Действие с проектом\iOS", где вам будет предложено загрузить дополнительно программное обеспечение, 
если оно ещё не было установлено. После завершения установки станут доступны новый функционал характерный для устройств 
iOS, особенно такие как _эмуляция_ iPhone и iPad. 

> **Примечание:**
> 
> Хотя эмулятор позволяет увидеть, как работает ваш проект на платформе iOS, но ни что не заменит полноценное тестирование
> на реальном устройстве.

### Xcode и iOS

Следующем шагом трудоёмкого процесса отладки игр на iOS будет установка _интегрированной среды разработки (IDE) Xcode_ 
от Apple. Если вы пользуетесь Mac, следовательно, у вас уже должен быть Apple ID. Тогда, просто скачиваем Xcode с App 
Store на свой Mac и устанавливаем его.

Выполним ещё несколько шагов, чтобы развернуть проект Ren’Py на iOS.

1. **Зарегистрируйтесь в программе _Apple Developer Program_**, перейдя по ссылке: 
https://developer.apple.com/programs/enroll/. Будьте готовы заплатить ежегодно 99 долларов США за участия в данной 
программе.
2. **Через лаунчер Ren’Py создайте новый проект для Xcode**. Для этого выберите 
_"Действие с проектом\iOS\Выбрать Директорию Проектов Xcode"_. Затем _"Создать Проект Xcode"_. Имя проекта будет 
автоматически взято с названия игры в Ren’Py.
3. Далее для **открытия проекта** нажмите _"Запустить Xcode"_.
4. **Добавьте свой Apple ID в Xcode**. Выбираем пункт меню _"Xcode\Preferences"_ и переходим на вкладку _"Accounts"_. 
Используя кнопку плюс в нижней части окна, добавляем свой Apple ID к проекту.
5. **Назначьте свой проект команде**. В Xcode выбираем проект, переходим на вкладку _"General"_, находим раздел 
_"Signing"_. Убеждаемся, что флажок _"Automatically manage signing"_ установлен, и по надобности выбираем команду в 
поле _"Team"_.
6. **Запускаем игры на iOS устройстве**. Подключите устройство к Mac. После запуска проекта на реальном устройстве, 
Xcode настроит все необходимые подписи для развертывания приложения.
7. **Экспортируйте _сертификаты_ и _профили_**. Для этого выбираем пункт меню _"Xcode\Preferences"_ и переходим на 
вкладку _"Accounts"_. Далее внизу окна нажимаем шестерёнку, после чего в выпавшем списке выбираем _"Export Accounts"_.
8. **В открывшемся окне введите имя файла в поле _"Save As"_** и пароль в поля _"Password"_ и _"Verify"_, после чего 
нажмите кнопку _"Save"_. Теперь сохранённый файл с вашей учетной записью разработчика надежно зашифрован и защищен.

Если вам понадобиться восстановить учетную запись разработчика в Xcode, то просто на вкладке "Accounts" выберите 
_"Import Accounts"_ укажите ранее сохранённый файл и нажмите _"Open"_.

### Обновляем ваши iOS-проекты
